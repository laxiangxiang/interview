<!DOCTYPE html>
<!-- saved from url=(0181)file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html -->
<html lang="zh-cn"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="referrer" content="origin">
    <title>JVM调优总结 - Andrew.Zhou - 博客园</title>
<meta property="og:description" content="转载: &#39;JVM调优总结（一） 一些概念&#39; 转载: &#39;JVM调优总结（二） 一些概念&#39; 转载: &#39;JVM调优总结（三） 基本垃圾回收算法&#39; 转载: &#39;JVM调优总结（四） 垃圾回收面临的问题&#39; 转载:">
    <link type="text/css" rel="stylesheet" href="./JVM调优总结_files/blog-common.css">
<link id="MainCss" type="text/css" rel="stylesheet" href="./JVM调优总结_files/bundle-LoveIsIntheAir.css">
<link type="text/css" rel="stylesheet" href="./JVM调优总结_files/246678.css">
<link id="mobile-style" media="only screen and (max-width: 767px)" type="text/css" rel="stylesheet" href="./JVM调优总结_files/bundle-LoveIsIntheAir-mobile.css">
    <link title="RSS" type="application/rss+xml" rel="alternate" href="https://www.cnblogs.com/andy-zhou/rss">
    <link title="RSD" type="application/rsd+xml" rel="EditURI" href="https://www.cnblogs.com/andy-zhou/rsd.xml">
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="https://www.cnblogs.com/andy-zhou/wlwmanifest.xml">
    <script async="" src="./JVM调优总结_files/analytics.js.下载"></script><script async="" src="./JVM调优总结_files/analytics.js(1).下载"></script><script src="./JVM调优总结_files/jquery-2.2.0.min.js.下载"></script><style type="text/css" abt="234"></style>
    <script>var currentBlogId=246678;var currentBlogApp='andy-zhou',cb_enable_mathjax=true;var isLogined=false;</script>
    <script type="text/x-mathjax-config;executed=true">
    MathJax.Hub.Config({
        tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']], processClass: 'math', processEscapes: true },
        TeX: { 
            equationNumbers: { autoNumber: ['AMS'], useLabelIds: true }, 
            extensions: ['extpfeil.js'],
            Macros: {bm: "\\boldsymbol"}
        },
        'HTML-CSS': { linebreaks: { automatic: true } },
        SVG: { linebreaks: { automatic: true } }
        });
    </script><script src="./JVM调优总结_files/MathJax.js.下载"></script><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style>
<script src="./JVM调优总结_files/blog-common.js.下载" type="text/javascript"></script>
<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><script>//remove 17173 video ad
doAdblock();
function doAdblock(){
    (function() {
        function A() {}
        A.prototype = {
            rules: {
                '17173_in':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/PreloaderFile(Customer)?\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_in_20150522.swf"
                },
                '17173_out':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/PreloaderFileFirstpage\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_out_20150522.swf"
                },
                '17173_live':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/Player_stream(_firstpage)?\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_stream_20150522.swf"
                },
                '17173_live_out':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/Player_stream_(custom)?Out\.swf/,
                    'replace':"http://swf.adtchrome.com/17173.out.Live.swf"
                }
            },
            _done: null,
            get done() {
                if(!this._done) {
                    this._done = new Array();
                }
                return this._done;
            },
            addAnimations: function() {
                var style = document.createElement('style');
                style.type = 'text/css';
                style.innerHTML = 'object,embed{\
                -webkit-animation-duration:.001s;-webkit-animation-name:playerInserted;\
                -ms-animation-duration:.001s;-ms-animation-name:playerInserted;\
                -o-animation-duration:.001s;-o-animation-name:playerInserted;\
                animation-duration:.001s;animation-name:playerInserted;}\
                @-webkit-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @-ms-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @-o-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}';
                document.getElementsByTagName('head')[0].appendChild(style);
            },
            animationsHandler: function(e) {
                if(e.animationName === 'playerInserted') {
                    this.replace(e.target);
                }
            },
            replace: function(elem) {
                if(this.done.indexOf(elem) != -1) return;
                this.done.push(elem);
                var player = elem.data || elem.src;
                if(!player) return;
                var i, find, replace = false;
                for(i in this.rules) {
                    find = this.rules[i]['find'];
                    if(find.test(player)) {
                        replace = this.rules[i]['replace'];
                        if('function' === typeof this.rules[i]['preHandle']) {
                            this.rules[i]['preHandle'].bind(this, elem, find, replace, player)();
                        }else{
                            this.reallyReplace.bind(this, elem, find, replace)();
                        }
                        break;
                    }
                }
            },
            reallyReplace: function(elem, find, replace) {
                elem.data && (elem.data = elem.data.replace(find, replace)) || elem.src && ((elem.src = elem.src.replace(find, replace)) && (elem.style.display = 'block'));
                var b = elem.querySelector("param[name='movie']");
                this.reloadPlugin(elem);
            },
            reloadPlugin: function(elem) {
                var nextSibling = elem.nextSibling;
                var parentNode = elem.parentNode;
                parentNode.removeChild(elem);
                var newElem = elem.cloneNode(true);
                this.done.push(newElem);
                if(nextSibling) {
                    parentNode.insertBefore(newElem, nextSibling);
                } else {
                    parentNode.appendChild(newElem);
                }
            },
            init: function() {
                var handler = this.animationsHandler.bind(this);
                document.body.addEventListener('webkitAnimationStart', handler, false);
                document.body.addEventListener('msAnimationStart', handler, false);
                document.body.addEventListener('oAnimationStart', handler, false);
                document.body.addEventListener('animationstart', handler, false);
                this.addAnimations();
            }
        };
        new A().init();
    })();
}
//remove baidu search ad
if(document.URL.indexOf('www.baidu.com') >= 0){
    if(document && document.getElementsByTagName && document.getElementById && document.body){
        var aa = function(){
            var all = document.body.querySelectorAll("#content_left div,#content_left table");
            for(var i = 0; i < all.length; i++){
                if(/display:\s?(table|block)\s!important/.test(all[i].getAttribute("style"))){all[i].style.display= "none";all[i].style.visibility='hidden';}
            }
            all = document.body.querySelectorAll('.result.c-container[id="1"]');
            //if(all.length == 1) return;
            for(var i = 0; i < all.length; i++){
                if(all[i].innerHTML && all[i].innerHTML.indexOf('广告')>-1){
                    all[i].style.display= "none";all[i].style.visibility='hidden';
                }
            }
        }
        aa();
        document.getElementById('wrapper_wrapper').addEventListener('DOMSubtreeModified',aa)
    };
}
//remove sohu video ad
if (document.URL.indexOf("tv.sohu.com") >= 0){
    if (document.cookie.indexOf("fee_status=true")==-1){document.cookie='fee_status=true'};
}
//remove 56.com video ad
if (document.URL.indexOf("56.com") >= 0){
    if (document.cookie.indexOf("fee_status=true")==-1){document.cookie='fee_status=true'};
}
//fore iqiyi enable html5 player function
if (document.URL.indexOf("iqiyi.com") >= 0){
    if (document.cookie.indexOf("player_forcedType=h5_VOD")==-1){
        document.cookie='player_forcedType=h5_VOD'
        if(localStorage.reloadTime && Date.now() - parseInt(localStorage.reloadTime)<60000){
            console.log('no reload')
        }else{
            location.reload()
            localStorage.reloadTime = Date.now();
        }
    }
}
</script><style type="text/css">object,embed{                -webkit-animation-duration:.001s;-webkit-animation-name:playerInserted;                -ms-animation-duration:.001s;-ms-animation-name:playerInserted;                -o-animation-duration:.001s;-o-animation-name:playerInserted;                animation-duration:.001s;animation-name:playerInserted;}                @-webkit-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @-ms-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @-o-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://mathjax.cnblogs.com/2_7_2/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.2') format('woff'), url('https://mathjax.cnblogs.com/2_7_2/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://mathjax.cnblogs.com/2_7_2/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.2') format('woff'), url('https://mathjax.cnblogs.com/2_7_2/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://mathjax.cnblogs.com/2_7_2/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.2') format('woff'), url('https://mathjax.cnblogs.com/2_7_2/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://mathjax.cnblogs.com/2_7_2/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.2') format('woff'), url('https://mathjax.cnblogs.com/2_7_2/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://mathjax.cnblogs.com/2_7_2/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.2') format('woff'), url('https://mathjax.cnblogs.com/2_7_2/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://mathjax.cnblogs.com/2_7_2/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.2') format('woff'), url('https://mathjax.cnblogs.com/2_7_2/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://mathjax.cnblogs.com/2_7_2/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.2') format('woff'), url('https://mathjax.cnblogs.com/2_7_2/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://mathjax.cnblogs.com/2_7_2/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.2') format('woff'), url('https://mathjax.cnblogs.com/2_7_2/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.2') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://mathjax.cnblogs.com/2_7_2/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.2') format('woff'), url('https://mathjax.cnblogs.com/2_7_2/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.2') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><link rel="preload" href="./JVM调优总结_files/f.txt" as="script"><script type="text/javascript" src="./JVM调优总结_files/f.txt"></script><script src="./JVM调优总结_files/pubads_impl_2019032001.js.下载" async=""></script></head>
<body><div id="MathJax_Message" style="display: none;"></div><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
<a name="top"></a>


<!--done-->
<center>
<div id="home">
<div id="header">
	<div id="blogTitle">
	<a id="lnkBlogLogo" href="https://www.cnblogs.com/andy-zhou/"><img id="blogLogo" src="./JVM调优总结_files/logo.gif" alt=""></a>			
		
<!--done-->
<h1><a id="Header1_HeaderTitle" class="headermaintitle" href="https://www.cnblogs.com/andy-zhou/">Andy.Zhou</a></h1>
<h2></h2>



		
	</div><!--end: blogTitle 博客的标题和副标题 -->
	<div id="navigator">
		
<ul id="navList">
	<li><a id="blog_nav_sitehome" class="menu" href="https://www.cnblogs.com/">博客园</a></li>
	<li><a id="blog_nav_myhome" class="menu" href="https://www.cnblogs.com/andy-zhou/">首页</a></li>
	<li><a id="blog_nav_newpost" class="menu" rel="nofollow" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">新随笔</a></li>
	<li><a id="blog_nav_contact" accesskey="9" class="menu" rel="nofollow" href="https://msg.cnblogs.com/send/Andrew.Zhou">联系</a></li>
	<li><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://i.cnblogs.com/">管理</a></li>
	<li><a id="blog_nav_rss" class="menu" href="https://www.cnblogs.com/andy-zhou/rss">订阅</a>
	<a id="blog_nav_rss_image" class="aHeaderXML" href="https://www.cnblogs.com/andy-zhou/rss"><img src="./JVM调优总结_files/xml.gif" alt="订阅"></a></li>
</ul>
		<div class="blogStats">
			
			<div id="blog_stats">
<!--done-->
随笔- 216&nbsp;
文章- 2&nbsp;
评论- 36&nbsp;
</div>
			
		</div><!--end: blogStats -->
	</div><!--end: navigator 博客导航栏 -->
</div><!--end: header 头部 -->

<div class="clear"></div>
	<div id="topicList">
		
        <div id="post_detail">
<!--done-->
<div id="topics">
	<div class="post">
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/andy-zhou/p/5327288.html">JVM调优总结</a>
		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown"><blockquote><h4>目录</h4><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_0"><strong>数据类型</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_1"><strong>堆与栈</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_2"><strong>Java对象的大小</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_3"><strong>引用类型</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_4"><strong>按照基本回收策略分</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_5"><strong>按分区对待的方式分</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_6"><strong>按系统线程分</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_7"><strong>如何区分垃圾</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_8"><strong>如何处理碎片</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_9"><strong>如何解决同时存在的对象创建和对象回收问题</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_10"><strong>为什么要分代</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_11"><strong>如何分代</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_12"><strong>什么情况下触发垃圾回收</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_13"><strong>分代垃圾回收流程示意</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_14"><strong>选择合适的垃圾收集算法</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_15"><strong>小结</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_16"><strong>回收器选择</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_17"><strong>辅助信息</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_18"><strong>常见配置汇总</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_19"><strong>调优总结</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_20"><strong>垃圾回收的瓶颈</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_21"><strong>增量收集的演进</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_22"><strong>Garbage Firest（G1）</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_23"><strong>展望</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_24"><strong>JVM调优工具</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_25"><strong>如何调优</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_26"><strong>线程监控</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_27"><strong>内存泄漏检查</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_28"><strong>垃圾回收的悖论</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_29"><strong>我们的内存中都放了什么</strong></a><br><a href="file:///C:/users/lxx/desktop/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E7%AC%94%E8%AE%B0/jvm%E8%B0%83%E4%BC%98%E6%80%BB%E7%BB%93%20-%20andrew.zhou%20-%20%E5%8D%9A%E5%AE%A2%E5%9B%AD.html#_caption_30"><strong>解决之道</strong></a><br></blockquote><blockquote><h4>目录</h4><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_0" target="_blank"><strong>数据类型</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_1" target="_blank"><strong>堆与栈</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_2" target="_blank"><strong>Java对象的大小</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_3" target="_blank"><strong>引用类型</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_4" target="_blank"><strong>按照基本回收策略分</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_5" target="_blank"><strong>按分区对待的方式分</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_6" target="_blank"><strong>按系统线程分</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_7" target="_blank"><strong>如何区分垃圾</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_8" target="_blank"><strong>如何处理碎片</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_9" target="_blank"><strong>如何解决同时存在的对象创建和对象回收问题</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_10" target="_blank"><strong>为什么要分代</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_11" target="_blank"><strong>如何分代</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_12" target="_blank"><strong>什么情况下触发垃圾回收</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_13" target="_blank"><strong>分代垃圾回收流程示意</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_14" target="_blank"><strong>选择合适的垃圾收集算法</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_15" target="_blank"><strong>小结</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_16" target="_blank"><strong>回收器选择</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_17" target="_blank"><strong>辅助信息</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_18" target="_blank"><strong>常见配置汇总</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_19" target="_blank"><strong>调优总结</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_20" target="_blank"><strong>垃圾回收的瓶颈</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_21" target="_blank"><strong>增量收集的演进</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_22" target="_blank"><strong>Garbage Firest（G1）</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_23" target="_blank"><strong>展望</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_24" target="_blank"><strong>JVM调优工具</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_25" target="_blank"><strong>如何调优</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_26" target="_blank"><strong>线程监控</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_27" target="_blank"><strong>内存泄漏检查</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_28" target="_blank"><strong>垃圾回收的悖论</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_29" target="_blank"><strong>我们的内存中都放了什么</strong></a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#_caption_30" target="_blank"><strong>解决之道</strong></a><br></blockquote><blockquote>
<h3 id="转载-jvm调优总结一---一些概念">转载: <a href="http://pengjiaheng.iteye.com/blog/518623" target="_blank">JVM调优总结（一）-- 一些概念</a></h3>
<h3 id="转载-jvm调优总结二---一些概念">转载: <a href="http://pengjiaheng.iteye.com/blog/519471" target="_blank">JVM调优总结（二）-- 一些概念</a></h3>
<h3 id="转载-jvm调优总结三---基本垃圾回收算法">转载: <a href="http://pengjiaheng.iteye.com/blog/520228" target="_blank">JVM调优总结（三）-- 基本垃圾回收算法</a></h3>
<h3 id="转载-jvm调优总结四---垃圾回收面临的问题">转载: <a href="http://pengjiaheng.iteye.com/blog/523230" target="_blank">JVM调优总结（四）-- 垃圾回收面临的问题</a></h3>
<h3 id="转载-jvm调优总结五---分代垃圾回收详述1">转载: <a href="http://pengjiaheng.iteye.com/blog/524024" target="_blank">JVM调优总结（五）-- 分代垃圾回收详述1</a></h3>
<h3 id="转载-jvm调优总结六---分代垃圾回收详述2">转载: <a href="http://pengjiaheng.iteye.com/blog/528034" target="_blank">JVM调优总结（六）-- 分代垃圾回收详述2</a></h3>
<h3 id="转载-jvm调优总结七---典型配置举例1">转载: <a href="http://pengjiaheng.iteye.com/blog/538582" target="_blank">JVM调优总结（七）-- 典型配置举例1</a></h3>
<h3 id="转载-jvm调优总结八---典型配置举例2">转载: <a href="http://pengjiaheng.iteye.com/blog/545015" target="_blank">JVM调优总结（八）-- 典型配置举例2</a></h3>
<h3 id="转载-jvm调优总结九---新一代的垃圾回收算法">转载: <a href="http://pengjiaheng.iteye.com/blog/548472" target="_blank">JVM调优总结（九）-- 新一代的垃圾回收算法</a></h3>
<h3 id="转载-jvm调优总结十---调优方法">转载: <a href="http://pengjiaheng.iteye.com/blog/552456" target="_blank">JVM调优总结（十）-- 调优方法</a></h3>
<h3 id="转载-jvm调优总结十一---反思">转载: <a href="http://pengjiaheng.iteye.com/blog/558619" target="_blank">JVM调优总结（十一）-- 反思</a></h3>
</blockquote>
<h1 id="一些概念">一些概念</h1>
<a name="_caption_0" target="_blank"></a><a name="_caption_0"></a><h2 id="数据类型">数据类型</h2>
<p>Java虚拟机中，数据类型可以分为两类：基本类型和引用类型。基本类型的变量保存原始值，即：他代表的值就是数值本身；而引用类型的变量保存引用值。“引用值”代表了某个对象的引用，而不是对象本身，对象本身存放在这个引用值所表示的地址的位置。</p>
<h4 id="基本类型包括byteshortintlongcharfloatdoublebooleanreturnaddress">基本类型包括：byte,short,int,long,char,float,double,Boolean,returnAddress</h4>
<h4 id="引用类型包括类类型接口类型和数组">引用类型包括：类类型，接口类型和数组。</h4>
<a name="_caption_1" target="_blank"></a><a name="_caption_1"></a><h2 id="堆与栈">堆与栈</h2>
<p>堆和栈是程序运行的关键，很有必要把他们的关系说清楚。</p>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning001.gif" title="JVM Tuning 001"></p>
<p><font color="#0099ff">栈是运行时的单位，而堆是存储的单位。</font></p>
<p>栈解决程序的运行问题，即程序如何执行，或者说如何处理数据；堆解决的是数据存储的问题，即数据怎么放、放在哪儿。</p>
<p>在Java中一个线程就会相应有一个线程栈与之对应，这点很容易理解，因为不同的线程执行逻辑有所不同，因此需要一个独立的线程栈。而堆则是所有线程共享的。栈因为是运行单位，因此里面存储的信息都是跟当前线程（或程序）相关信息的。包括局部变量、程序运行状态、方法返回值等等；而堆只负责存储对象信息。</p>
<p><font color="#0099ff">为什么要把堆和栈区分出来呢？栈中不是也可以存储数据吗？</font></p>
<p>第一，从软件设计的角度看，<font color="#c7254e">栈代表了处理逻辑</font>，而<font color="#c7254e">堆代表了数据</font>。这样分开，使得处理逻辑更为清晰。<font color="#c7254e">分而治之的思想</font>。这种隔离、模块化的思想在软件设计的方方面面都有体现。</p>
<p>第二，堆与栈的分离，使得堆中的内容可以被多个栈<font color="#c7254e">共享</font>（也可以理解为多个线程访问同一个对象）。这种共享的收益是很多的。一方面这种共享提供了一种有效的数据交互方式(如：共享内存)，另一方面，堆中的共享常量和缓存可以被所有栈访问，节省了空间。</p>
<p>第三，栈因为运行时的需要，比如保存系统运行的上下文，需要进行地址段的划分。由于栈只能向上增长，因此就会限制住栈存储内容的能力。而堆不同，堆中的对象是可以根据需要动态增长的，因此栈和堆的拆分，使得<font color="#c7254e">动态增长成为可能</font>，相应栈中只需记录堆中的一个地址即可。</p>
<p>第四，<font color="#c7254e">面向对象就是堆和栈的完美结合</font>。其实，面向对象方式的程序与以前结构化的程序在执行上没有任何区别。但是，面向对象的引入，使得对待问题的思考方式发生了改变，而更接近于自然方式的思考。当我们把对象拆开，你会发现，对象的属性其实就是数据，存放在堆中；而对象的行为（方法），就是运行逻辑，放在栈中。我们在编写对象的时候，其实即编写了数据结构，也编写的处理数据的逻辑。不得不承认，面向对象的设计，确实很美。</p>
<p><font color="#0099ff">在Java中，Main函数就是栈的起始点，也是程序的起始点。</font></p>
<p>程序要运行总是有一个起点的。同C语言一样，java中的Main就是那个起点。无论什么java程序，找到main就找到了程序执行的入口：）</p>
<p><font color="#0099ff">堆中存什么？栈中存什么？</font></p>
<p>堆中存的是<font color="#c7254e">对象</font>。栈中存的是<font color="#c7254e">基本数据类型</font>和<font color="#c7254e">堆中对象的引用</font>。一个对象的大小是不可估计的，或者说是可以动态变化的，但是在栈中，一个对象只对应了一个4btye的引用（堆栈分离的好处：））。</p>
<p>为什么不把基本类型放堆中呢？因为其占用的空间一般是1~8个字节——需要空间比较少，而且因为是基本类型，所以不会出现动态增长的情况——长度固定，因此栈中存储就够了，如果把他存在堆中是没有什么意义的（还会浪费空间，后面说明）。可以这么说，基本类型和对象的引用都是存放在栈中，而且都是几个字节的一个数，因此在程序运行时，他们的处理方式是统一的。但是基本类型、对象引用和对象本身就有所区别了，因为一个是栈中的数据一个是堆中的数据。最常见的一个问题就是，Java中参数传递时的问题。</p>
<p><font color="#0099ff">Java中的参数传递时传值呢？还是传引用？</font></p>
<p>要说明这个问题，先要明确两点：</p>
<h4 id="不要试图与c进行类比java中没有指针的概念">1. 不要试图与C进行类比，Java中没有指针的概念</h4>
<h4 id="程序运行永远都是在栈中进行的因而参数传递时只存在传递基本类型和对象引用的问题不会直接传对象本身">2. 程序运行永远都是在栈中进行的，因而参数传递时，只存在传递基本类型和对象引用的问题。不会直接传对象本身。</h4>
<p>明确以上两点后。Java在方法调用传递参数时，因为没有指针，所以它都是进行传值调用（这点可以参考C的传值调用）。因此，很多书里面都说Java是进行传值调用，这点没有问题，而且也简化的C中复杂性。</p>
<p>但是传引用的错觉是如何造成的呢？在运行栈中，<font color="#c7254e">基本类型和引用的处理是一样的，都是传值</font>，所以，如果是传引用的方法调用，也同时可以理解为“传引用值”的传值调用，即引用的处理跟基本类型是完全一样的。但是当进入被调用方法时，被传递的这个引用的值，被程序解释（或者查找）到堆中的对象，这个时候才对应到真正的对象。如果此时进行修改，修改的是引用对应的对象，而不是引用本身，即：修改的是堆中的数据。所以这个修改是可以保持的了。</p>
<p>对象，从某种意义上说，是由基本类型组成的。<font color="#c7254e">可以把一个对象看作为一棵树，对象的属性如果还是对象，则还是一颗树（即非叶子节点），基本类型则为树的叶子节点</font>。程序参数传递时，被传递的值本身都是不能进行修改的，但是，如果这个值是一个非叶子节点（即一个对象引用），则可以修改这个节点下面的所有内容。</p>
<p>堆和栈中，栈是程序运行最根本的东西。程序运行可以没有堆，但是不能没有栈。而堆是为栈进行数据存储服务，说白了堆就是一块共享的内存。不过，正是因为堆和栈的分离的思想，才使得Java的垃圾回收成为可能。</p>
<p>Java中，栈的大小通过-Xss来设置，当栈中存储数据比较多时，需要适当调大这个值，否则会出现java.lang.StackOverflowError异常。常见的出现这个异常的是无法返回的递归，因为此时栈中保存的信息都是方法返回的记录点。</p>
<a name="_caption_2" target="_blank"></a><a name="_caption_2"></a><h2 id="java对象的大小">Java对象的大小</h2>
<p>基本数据的类型的大小是固定的，这里就不多说了。对于非基本类型的Java对象，其大小就值得商榷。</p>
<p>在Java中，一个空<font color="#c7254e">Object对象的大小是8byte</font>，这个大小只是保存堆中一个没有任何属性的对象的大小。看下面语句：</p>
<pre class="java"><code class="hljs">Object ob = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Object();</code></pre>
<p>这样在程序中完成了一个Java对象的生命，但是它所占的空间为：<font color="#c7254e">4byte+8byte</font>。4byte是上面部分所说的Java栈中保存引用的所需要的空间。而那8byte则是Java堆中对象的信息。因为所有的Java非基本类型的对象都需要默认继承Object对象，因此不论什么样的Java对象，其大小都必须是大于8byte。</p>
<p>有了Object对象的大小，我们就可以计算其他对象的大小了。</p>
<pre class="java"><code class="hljs">Class NewObject {
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> count;
    <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> flag;
    Object ob;
}
    其大小为：空对象大小(<span class="hljs-number"><span class="hljs-number">8</span></span><span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)+<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>大小(<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)+Boolean大小(<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)+空Object引用的大小(<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)=<span class="hljs-number"><span class="hljs-number">17</span></span><span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>。但是因为Java在对对象内存分配时都是以<span class="hljs-number"><span class="hljs-number">8</span></span>的整数倍来分，因此大于<span class="hljs-number"><span class="hljs-number">17</span></span><span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>的最接近<span class="hljs-number"><span class="hljs-number">8</span></span>的整数倍的是<span class="hljs-number"><span class="hljs-number">24</span></span>，因此此对象的大小为<span class="hljs-number"><span class="hljs-number">24</span></span><span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>。</code></pre>
<p>这里需要注意一下<font color="#c7254e">基本类型的包装类型的大小</font>。因为这种包装类型已经成为对象了，因此需要把他们作为对象来看待。包装类型的大小至少是12byte（声明一个空Object至少需要的空间），而且12byte没有包含任何有效信息，同时，因为Java对象大小是8的整数倍，因此<font color="#c7254e">一个基本类型包装类的大小至少是16byte</font>。这个内存占用是很恐怖的，它是使用基本类型的N倍（N&gt;2），有些类型的内存占用更是夸张（随便想下就知道了）。因此，可能的话应尽量少使用包装类。在JDK5.0以后，因为加入了自动类型装换，因此，Java虚拟机会在存储方面进行相应的优化。</p>
<a name="_caption_3" target="_blank"></a><a name="_caption_3"></a><h2 id="引用类型">引用类型</h2>
<p>对象引用类型分为<font color="#c7254e">强引用、软引用、弱引用和虚引用</font>。</p>
<p><font color="#0099ff">强引用</font>:就是我们一般声明对象是时虚拟机生成的引用，强引用环境下，垃圾回收时需要严格判断当前对象是否被强引用，如果被强引用，则不会被垃圾回收</p>
<p><font color="#0099ff">软引用</font>:软引用一般被做为缓存来使用。与强引用的区别是，软引用在垃圾回收时，虚拟机会根据当前系统的剩余内存来决定是否对软引用进行回收。如果剩余内存比较紧张，则虚拟机会回收软引用所引用的空间；如果剩余内存相对富裕，则不会进行回收。换句话说，虚拟机在发生OutOfMemory时，肯定是没有软引用存在的。</p>
<p><font color="#0099ff">弱引用</font>:弱引用与软引用类似，都是作为缓存来使用。但与软引用不同，弱引用在进行垃圾回收时，是一定会被回收掉的，因此其生命周期只存在于一个垃圾回收周期内。</p>
<p>强引用不用说，我们系统一般在使用时都是用的强引用。而“软引用”和“弱引用”比较少见。他们一般被作为缓存使用，而且一般是在内存大小比较受限的情况下做为缓存。因为如果内存足够大的话，可以直接使用强引用作为缓存即可，同时可控性更高。因而，他们常见的是被使用在桌面应用系统的缓存。</p>
<p>可以从不同的的角度去划分垃圾回收算法：</p>
<a name="_caption_4" target="_blank"></a><a name="_caption_4"></a><h2 id="按照基本回收策略分">按照基本回收策略分</h2>
<p><font color="#0099ff">引用计数（Reference Counting）:</font></p>
<p>比较古老的回收算法。原理是此对象有一个引用，即增加一个计数，删除一个引用则减少一个计数。垃圾回收时，只用收集计数为0的对象。此算法最致命的是无法处理循环引用的问题。</p>
<p><font color="#0099ff">标记-清除（Mark-Sweep）:</font></p>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning002.png" title="JVM Tuning 002"></p>
<p>此算法执行分两阶段。第一阶段从引用根节点开始标记所有被引用的对象，第二阶段遍历整个堆，把未标记的对象清除。此算法需要暂停整个应用，同时，会产生内存碎片。</p>
<p><font color="#0099ff">复制（Copying）:</font></p>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning003.png" title="JVM Tuning 003"></p>
<p>此算法把内存空间划为两个相等的区域，每次只使用其中一个区域。垃圾回收时，遍历当前使用区域，把正在使用中的对象复制到另外一个区域中。次算法每次只处理正在使用中的对象，因此复制成本比较小，同时复制过去以后还能进行相应的内存整理，不会出现“碎片”问题。当然，此算法的缺点也是很明显的，就是需要两倍内存空间。</p>
<p><font color="#0099ff">标记-整理（Mark-Compact）:</font></p>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning004.png" title="JVM Tuning 004"></p>
<p>此算法结合了“标记-清除”和“复制”两个算法的优点。也是分两阶段，第一阶段从根节点开始标记所有被引用对象，第二阶段遍历整个堆，把清除未标记对象并且把存活对象“压缩”到堆的其中一块，按顺序排放。此算法避免了“标记-清除”的碎片问题，同时也避免了“复制”算法的空间问题。</p>
<a name="_caption_5" target="_blank"></a><a name="_caption_5"></a><h2 id="按分区对待的方式分">按分区对待的方式分</h2>
<p><font color="#0099ff">增量收集（Incremental Collecting）:</font>实时垃圾回收算法，即：在应用进行的同时进行垃圾回收。不知道什么原因JDK5.0中的收集器没有使用这种算法的。</p>
<p><font color="#0099ff">分代收集（Generational Collecting）:</font>基于对对象生命周期分析后得出的垃圾回收算法。把对象分为年青代、年老代、持久代，对不同生命周期的对象使用不同的算法（上述方式中的一个）进行回收。现在的垃圾回收器（从J2SE1.2开始）都是使用此算法的。</p>
<a name="_caption_6" target="_blank"></a><a name="_caption_6"></a><h2 id="按系统线程分">按系统线程分</h2>
<p><font color="#0099ff">串行收集:</font>串行收集使用单线程处理所有垃圾回收工作, 因为无需多线程交互，实现容易，而且效率比较高。但是，其局限性也比较明显，即无法使用多处理器的优势，所以此收集适合单处理器机器。当然，此收集器也可以用在小数据量（100M左右）情况下的多处理器机器上。</p>
<p><font color="#0099ff">并行收集:</font>并行收集使用多线程处理垃圾回收工作，因而速度快，效率高。而且理论上CPU数目越多，越能体现出并行收集器的优势。</p>
<p><font color="#0099ff">并发收集:</font>相对于串行收集和并行收集而言，前面两个在进行垃圾回收工作时，需要暂停整个运行环境，而只有垃圾回收程序在运行，因此，系统在垃圾回收时会有明显的暂停，而且暂停时间会因为堆越大而越长。</p>
<a name="_caption_7" target="_blank"></a><a name="_caption_7"></a><h2 id="如何区分垃圾">如何区分垃圾</h2>
<p>上面说到的“引用计数”法，通过统计控制生成对象和删除对象时的引用数来判断。垃圾回收程序收集计数为0的对象即可。但是这种方法无法解决循环引用。所以，后来实现的垃圾判断算法中，都是从程序运行的根节点出发，遍历整个对象引用，查找存活的对象。那么在这种方式的实现中，<font color="#c7254e">垃圾回收从哪儿开始的呢</font>？即，从哪儿开始查找哪些对象是正在被当前系统使用的。上面分析的堆和栈的区别，其中栈是真正进行程序执行地方，所以要获取哪些对象正在被使用，则需要从Java栈开始。同时，一个栈是与一个线程对应的，因此，如果有多个线程的话，则必须对这些线程对应的所有的栈进行检查。</p>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning005.png" title="JVM Tuning 005"></p>
<p>同时，除了栈外，还有系统运行时的寄存器等，也是存储程序运行数据的。这样，以栈或寄存器中的引用为起点，我们可以找到堆中的对象，又从这些对象找到对堆中其他对象的引用，这种引用逐步扩展，最终以null引用或者基本类型结束，这样就形成了一颗以Java栈中引用所对应的对象为根节点的一颗对象树，如果栈中有多个引用，则最终会形成多颗对象树。在这些对象树上的对象，都是当前系统运行所需要的对象，不能被垃圾回收。而其他剩余对象，则可以视为无法被引用到的对象，可以被当做垃圾进行回收。</p>
<p>因此，<font color="#c7254e">垃圾回收的起点是一些根对象（java栈, 静态变量, 寄存器...）</font>。而最简单的Java栈就是Java程序执行的main函数。这种回收方式，也是上面提到的“标记-清除”的回收方式</p>
<a name="_caption_8" target="_blank"></a><a name="_caption_8"></a><h2 id="如何处理碎片">如何处理碎片</h2>
<p>由于不同Java对象存活时间是不一定的，因此，在程序运行一段时间以后，如果不进行内存整理，就会出现零散的内存碎片。碎片最直接的问题就是会导致无法分配大块的内存空间，以及程序运行效率降低。所以，在上面提到的基本垃圾回收算法中，“复制”方式和“标记-整理”方式，都可以解决碎片的问题。</p>
<a name="_caption_9" target="_blank"></a><a name="_caption_9"></a><h2 id="如何解决同时存在的对象创建和对象回收问题">如何解决同时存在的对象创建和对象回收问题</h2>
<p>垃圾回收线程是回收内存的，而程序运行线程则是消耗（或分配）内存的，一个回收内存，一个分配内存，从这点看，两者是矛盾的。因此，在现有的垃圾回收方式中，要进行垃圾回收前，一般都需要暂停整个应用（即：暂停内存的分配），然后进行垃圾回收，回收完成后再继续应用。这种实现方式是最直接，而且最有效的解决二者矛盾的方式。</p>
<p>但是<font color="#c7254e">这种方式有一个很明显的弊端，就是当堆空间持续增大时，垃圾回收的时间也将会相应的持续增大，对应应用暂停的时间也会相应的增大</font>。一些对相应时间要求很高的应用，比如最大暂停时间要求是几百毫秒，那么当堆空间大于几个G时，就很有可能超过这个限制，在这种情况下，垃圾回收将会成为系统运行的一个瓶颈。为解决这种矛盾，有了<font color="#c7254e">并发垃圾回收算法</font>，使用这种算法，垃圾回收线程与程序运行线程同时运行。在这种方式下，解决了暂停的问题，但是因为需要在新生成对象的同时又要回收对象，算法复杂性会大大增加，系统的处理能力也会相应降低，同时，“碎片”问题将会比较难解决。</p>
<a name="_caption_10" target="_blank"></a><a name="_caption_10"></a><h2 id="为什么要分代">为什么要分代</h2>
<p>分代的垃圾回收策略，是基于这样一个事实：<font color="#c7254e">不同的对象的生命周期是不一样的</font>。因此，不同生命周期的对象可以采取不同的收集方式，以便提高回收效率。</p>
<p>在Java程序运行的过程中，会产生大量的对象，其中有些对象是与业务信息相关，比如Http请求中的Session对象、线程、Socket连接，这类对象跟业务直接挂钩，因此生命周期比较长。但是还有一些对象，主要是程序运行过程中生成的临时变量，这些对象生命周期会比较短，比如：String对象，由于其不变类的特性，系统会产生大量的这些对象，有些对象甚至只用一次即可回收。</p>
<p>试想，在不进行对象存活时间区分的情况下，每次垃圾回收都是对整个堆空间进行回收，花费时间相对会长，同时，因为每次回收都需要遍历所有存活对象，但实际上，对于生命周期长的对象而言，这种遍历是没有效果的，因为可能进行了很多次遍历，但是他们依旧存在。因此，分代垃圾回收采用分治的思想，进行代的划分，把不同生命周期的对象放在不同代上，不同代上采用最适合它的垃圾回收方式进行回收。</p>
<a name="_caption_11" target="_blank"></a><a name="_caption_11"></a><h2 id="如何分代">如何分代</h2>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning006.png" title="JVM Tuning 006"></p>
<p>如图所示：</p>
<p>虚拟机中的共划分为三个代：<font color="#c7254e">年轻代（Young Generation）</font>、<font color="#c7254e">年老点（Old Generation）</font>和<font color="#c7254e">持久代（Permanent Generation）</font>。其中持久代主要存放的是Java类的类信息，与垃圾收集要收集的Java对象关系不大。年轻代和年老代的划分是对垃圾收集影响比较大的。</p>
<p><font color="#0099ff">年轻代:</font></p>
<p>所有新生成的对象首先都是放在年轻代的。年轻代的目标就是尽可能快速的收集掉那些生命周期短的对象。年轻代分三个区。一个Eden区，两个Survivor区(一般而言)。大部分对象在Eden区中生成。当Eden区满时，还存活的对象将被复制到Survivor区（两个中的一个），当这个Survivor区满时，此区的存活对象将被复制到另外一个Survivor区，当这个Survivor去也满了的时候，从第一个Survivor区复制过来的并且此时还存活的对象，将被复制“年老区(Tenured)”。需要注意，Survivor的两个区是对称的，没先后关系，所以同一个区中可能同时存在从Eden复制过来 对象，和从前一个Survivor复制过来的对象，而复制到年老区的只有从第一个Survivor去过来的对象。而且，Survivor区总有一个是空的。同时，根据程序需要，Survivor区是可以配置为多个的（多于两个），这样可以增加对象在年轻代中的存在时间，减少被放到年老代的可能。</p>
<p><font color="#0099ff">年老代:</font></p>
<p>在年轻代中经历了N次垃圾回收后仍然存活的对象，就会被放到年老代中。因此，可以认为年老代中存放的都是一些生命周期较长的对象。</p>
<p><font color="#0099ff">持久代:</font></p>
<p>用于存放静态文件，如今Java类、方法等。持久代对垃圾回收没有显著影响，但是有些应用可能动态生成或者调用一些class，例如Hibernate等，在这种时候需要设置一个比较大的持久代空间来存放这些运行过程中新增的类。持久代大小通过-XX:MaxPermSize=<n>进行设置。</n></p>
<a name="_caption_12" target="_blank"></a><a name="_caption_12"></a><h2 id="什么情况下触发垃圾回收">什么情况下触发垃圾回收</h2>
<p>由于对象进行了分代处理，因此垃圾回收区域、时间也不一样。GC有两种类型：Scavenge GC和Full GC。</p>
<p><font color="#0099ff">Scavenge GC</font></p>
<p>一般情况下，当新对象生成，并且在Eden申请空间失败时，就会触发Scavenge GC，对Eden区域进行GC，清除非存活对象，并且把尚且存活的对象移动到Survivor区。然后整理Survivor的两个区。这种方式的GC是对年轻代的Eden区进行，不会影响到年老代。因为大部分对象都是从Eden区开始的，同时Eden区不会分配的很大，所以Eden区的GC会频繁进行。因而，一般在这里需要使用速度快、效率高的算法，使Eden去能尽快空闲出来。</p>
<p><font color="#0099ff">Full GC</font></p>
<p>对整个堆进行整理，包括Young、Tenured和Perm。Full GC因为需要对整个对进行回收，所以比Scavenge GC要慢，因此应该尽可能减少Full GC的次数。在对JVM调优的过程中，很大一部分工作就是对于FullGC的调节。有如下原因可能导致Full GC：</p>
<pre><code class="hljs less">· 年老代（<span class="hljs-selector-tag"><span class="hljs-selector-tag">Tenured</span></span>）被写满
· 持久代（<span class="hljs-selector-tag"><span class="hljs-selector-tag">Perm</span></span>）被写满 
· <span class="hljs-selector-tag"><span class="hljs-selector-tag">System</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.gc</span></span>()被显示调用 
·上一次<span class="hljs-selector-tag"><span class="hljs-selector-tag">GC</span></span>之后<span class="hljs-selector-tag"><span class="hljs-selector-tag">Heap</span></span>的各域分配策略动态变化</code></pre>
<a name="_caption_13" target="_blank"></a><a name="_caption_13"></a><h2 id="分代垃圾回收流程示意">分代垃圾回收流程示意</h2>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning007.png" title="JVM Tuning 007"></p>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning008.png" title="JVM Tuning 008"></p>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning009.png" title="JVM Tuning 009"></p>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning010.png" title="JVM Tuning 010"></p>
<a name="_caption_14" target="_blank"></a><a name="_caption_14"></a><h2 id="选择合适的垃圾收集算法">选择合适的垃圾收集算法</h2>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning011.png" title="JVM Tuning 011"></p>
<p>用单线程处理所有垃圾回收工作，因为无需多线程交互，所以效率比较高。但是，也无法使用多处理器的优势，所以此收集器适合单处理器机器。当然，此收集器也可以用在小数据量（100M左右）情况下的多处理器机器上。可以使用-XX:+UseSerialGC打开。</p>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning012.png" title="JVM Tuning 012"></p>
<p>对年轻代进行并行垃圾回收，因此可以减少垃圾回收时间。一般在多线程多处理器机器上使用。使用-XX:+UseParallelGC.打开。并行收集器在J2SE5.0第六6更新上引入，在Java SE6.0中进行了增强--可以对年老代进行并行收集。如果年老代不使用并发收集的话，默认是使用单线程进行垃圾回收，因此会制约扩展能力。使用-XX:+UseParallelOldGC打开。</p>
<p>使用-XX:ParallelGCThreads=<n>设置并行垃圾回收的线程数。此值可以设置与机器处理器数量相等。</n></p>
<p>此收集器可以进行如下配置：</p>
<blockquote>
<p><font color="#c7254e">最大垃圾回收暂停</font>:指定垃圾回收时的最长暂停时间，通过<font color="#c7254e">-XX:MaxGCPauseMillis=<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 3.596em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.971em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.357em, 1002.87em, 2.398em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mo" id="MathJax-Span-3" style="font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Math-italic; padding-left: 0.263em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span class="mo" id="MathJax-Span-5" style="font-family: MathJax_Main; padding-left: 0.263em;">&gt;</span></span><span style="display: inline-block; width: 0px; height: 2.19em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&lt;</mo><mi>N</mi><mo>&gt;</mo></math></span></span><script type="math/tex" id="MathJax-Element-1"><N></script></span></font>指定。&gt;<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6" style="width: 3.596em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.971em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.357em, 1002.87em, 2.398em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-7"><span class="mo" id="MathJax-Span-8" style="font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math-italic; padding-left: 0.263em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main; padding-left: 0.263em;">&gt;</span></span><span style="display: inline-block; width: 0px; height: 2.19em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&lt;</mo><mi>N</mi><mo>&gt;</mo></math></span></span><script type="math/tex" id="MathJax-Element-2"><N></script></span>为毫秒.如果指定了此值的话，堆大小和垃圾回收相关参数会进行调整以达到指定值。设定此值可能会减少应用的吞吐量。</p>
<p><font color="#c7254e">吞吐量</font>:吞吐量为垃圾回收时间与非垃圾回收时间的比值，通过<font color="#c7254e">-XX:GCTimeRatio=<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-11" style="width: 3.596em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.971em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.357em, 1002.87em, 2.398em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-12"><span class="mo" id="MathJax-Span-13" style="font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-14" style="font-family: MathJax_Math-italic; padding-left: 0.263em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span class="mo" id="MathJax-Span-15" style="font-family: MathJax_Main; padding-left: 0.263em;">&gt;</span></span><span style="display: inline-block; width: 0px; height: 2.19em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.122em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&lt;</mo><mi>N</mi><mo>&gt;</mo></math></span></span><script type="math/tex" id="MathJax-Element-3"><N></script></span></font>来设定，公&gt;式为<font color="#c7254e">1/（1+N）</font>。例如，<font color="#c7254e">-XX:GCTimeRatio=19</font>时，表示5%的时间用于垃圾回收。默认情况为99，即&gt;1%的时间用于垃圾回收。</p>
</blockquote>
<p><font color="#0099ff">并发收集器</font></p>
<p>可以保证大部分工作都并发进行（应用不停止），垃圾回收只暂停很少的时间，此收集器适合对响应时间要求比较高的中、大规模应用。使用-XX:+UseConcMarkSweepGC打开。</p>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning013.png" title="JVM Tuning 013"></p>
<p>并发收集器主要减少年老代的暂停时间，他在应用不停止的情况下使用独立的垃圾回收线程，跟踪可达对象。在每个年老代垃圾回收周期中，在收集初期并发收集器 会对整个应用进行简短的暂停，在收集中还会再暂停一次。第二次暂停会比第一次稍长，在此过程中多个线程同时进行垃圾回收工作。</p>
<p>并发收集器使用处理器换来短暂的停顿时间。在一个N个处理器的系统上，并发收集部分使用K/N个可用处理器进行回收，一般情况下1&lt;=K&lt;=N/4。</p>
<p>在只有一个处理器的主机上使用并发收集器，设置为incremental mode模式也可获得较短的停顿时间。</p>
<p><font color="#c7254e">浮动垃圾</font>：由于在应用运行的同时进行垃圾回收，所以有些垃圾可能在垃圾回收进行完成时产生，这样就造成了“Floating Garbage”，这些垃圾需要在下次垃圾回收周期时才能回收掉。所以，并发收集器一般需要20%的预留空间用于这些浮动垃圾。</p>
<p><font color="#c7254e">Concurrent Mode Failure</font>：并发收集器在应用运行时进行收集，所以需要保证堆在垃圾回收的这段时间有足够的空间供程序使用，否则，垃圾回收还未完成，堆空间先满了。这种情况下将会发生“并发模式失败”，此时整个应用将会暂停，进行垃圾回收。</p>
<p><font color="#c7254e">启动并发收集器</font>：因为并发收集在应用运行时进行收集，所以必须保证收集完成之前有足够的内存空间供程序使用，否则会出现“Concurrent Mode Failure”。通过设置-XX:CMSInitiatingOccupancyFraction=<n>指定还有多少剩余堆时开始执行并发收集</n></p>
<a name="_caption_15" target="_blank"></a><a name="_caption_15"></a><h2 id="小结">小结</h2>
<p><font color="#0099ff">串行处理器：</font></p>
<ul>
<li>适用情况：数据量比较小（100M左右）；单处理器下并且对响应时间无要求的应用。</li>
<li>缺点：只能用于小型应用</li>
</ul>
<p><font color="#0099ff">并行处理器：</font></p>
<ul>
<li>适用情况：“对吞吐量有高要求”，多CPU、对应用响应时间无要求的中、大型应用。举例：后台处理、科学计算。</li>
<li>缺点：垃圾收集过程中应用响应时间可能加长</li>
</ul>
<p><font color="#0099ff">并发处理器：</font></p>
<ul>
<li>适用情况：“对响应时间有高要求”，多CPU、对应用响应时间有较高要求的中、大型应用。举例：Web服务器/应用服务器、电信交换、集成开发环境。</li>
</ul>
<p>以下配置主要针对分代垃圾回收算法而言。<br>
##堆大小设置</p>
<p>年轻代的设置很关键<br>
JVM中最大堆大小有三方面限制：相关操作系统的数据模型（32-bt还是64-bit）限制；系统的可用虚拟内存限制；系统的可用物理内存限制。32位系统下，一般限制在1.5G~2G；64为操作系统对内存无限制。在Windows Server 2003 系统，3.5G物理内存，JDK5.0下测试，最大可设置为1478m。<br>
典型设置：</p>
<pre><code class="hljs diff">java -Xmx3550m -Xms3550m -Xmn2g –Xss128k

<span class="hljs-deletion"><span class="hljs-deletion">-Xmx3550m：设置JVM最大可用内存为3550M。</span></span>

<span class="hljs-deletion"><span class="hljs-deletion">-Xms3550m：设置JVM促使内存为3550m。此值可以设置与-Xmx相同，以避免每次垃圾回收完成后JVM重新分配内存。</span></span>

<span class="hljs-deletion"><span class="hljs-deletion">-Xmn2g：设置年轻代大小为2G。整个堆大小=年轻代大小 + 年老代大小 + 持久代大小。持久代一般固定大小为64m，所以增大年轻代后，将会减小年老代大小。此值对系统性能影响较大，Sun官方推荐配置为整个堆的3/8。</span></span>

<span class="hljs-deletion"><span class="hljs-deletion">-Xss128k：设置每个线程的堆栈大小。JDK5.0以后每个线程堆栈大小为1M，以前每个线程堆栈大小为256K。更具应用的线程所需内存大小进行调整。在相同物理内存下，减小这个值能生成更多的线程。但是操作系统对一个进程内的线程数还是有限制的，不能无限生成，经验值在3000~5000左右。</span></span></code></pre>
<pre><code class="hljs groovy">java -Xmx3550m -Xms3550m -Xss128k -<span class="hljs-string"><span class="hljs-string">XX:</span></span>NewRatio=<span class="hljs-number"><span class="hljs-number">4</span></span> -<span class="hljs-string"><span class="hljs-string">XX:</span></span>SurvivorRatio=<span class="hljs-number"><span class="hljs-number">4</span></span> -<span class="hljs-string"><span class="hljs-string">XX:</span></span>MaxPermSize=<span class="hljs-number"><span class="hljs-number">16</span></span>m -<span class="hljs-string"><span class="hljs-string">XX:</span></span>MaxTenuringThreshold=<span class="hljs-number"><span class="hljs-number">0</span></span>

-<span class="hljs-string"><span class="hljs-string">XX:</span></span>NewRatio=<span class="hljs-number"><span class="hljs-number">4</span></span>:设置年轻代（包括Eden和两个Survivor区）与年老代的比值（除去持久代）。设置为<span class="hljs-number"><span class="hljs-number">4</span></span>，则年轻代与年老代所占比值为<span class="hljs-number"><span class="hljs-number">1</span></span>：<span class="hljs-number"><span class="hljs-number">4</span></span>，年轻代占整个堆栈的<span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">5</span></span>

-<span class="hljs-string"><span class="hljs-string">XX:</span></span>SurvivorRatio=<span class="hljs-number"><span class="hljs-number">4</span></span>：设置年轻代中Eden区与Survivor区的大小比值。设置为<span class="hljs-number"><span class="hljs-number">4</span></span>，则两个Survivor区与一个Eden区的比值为<span class="hljs-number"><span class="hljs-number">2</span></span>:<span class="hljs-number"><span class="hljs-number">4</span></span>，一个Survivor区占整个年轻代的<span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">6</span></span>

-<span class="hljs-string"><span class="hljs-string">XX:</span></span>MaxPermSize=<span class="hljs-number"><span class="hljs-number">16</span></span><span class="hljs-string"><span class="hljs-string">m:</span></span>设置持久代大小为<span class="hljs-number"><span class="hljs-number">16</span></span>m。

-<span class="hljs-string"><span class="hljs-string">XX:</span></span>MaxTenuringThreshold=<span class="hljs-number"><span class="hljs-number">0</span></span>：设置垃圾最大年龄。如果设置为<span class="hljs-number"><span class="hljs-number">0</span></span>的话，则年轻代对象不经过Survivor区，直接进入年老代。对于年老代比较多的应用，可以提高效率。如果将此值设置为一个较大值，则年轻代对象会在Survivor区进行多次复制，这样可以增加对象再年轻代的存活时间，增加在年轻代即被回收的概论。</code></pre>
<a name="_caption_16" target="_blank"></a><a name="_caption_16"></a><h2 id="回收器选择">回收器选择</h2>
<p>JVM给了三种选择：串行收集器、并行收集器、并发收集器，但是串行收集器只适用于小数据量的情况，所以这里的选择主要针对并行收集器和并发收集器。默认情况下，JDK5.0以前都是使用串行收集器，如果想使用其他收集器需要在启动时加入相应参数。JDK5.0以后，JVM会根据当前<a href="http://docs.oracle.com/javase/1.5.0/docs/guide/vm/server-class.html" target="_blank"><font color="#0099ff">系统配置</font></a>进行判断。</p>
<p><font color="#0099ff">吞吐量优先的并行收集器</font></p>
<p>如上文所述，并行收集器主要以到达一定的吞吐量为目标，适用于科学技术和后台处理等。</p>
<h4 id="典型配置">典型配置：</h4>
<pre><code class="hljs groovy">java -Xmx3800m -Xms3800m -Xmn2g -Xss128k -<span class="hljs-string"><span class="hljs-string">XX:</span></span>+UseParallelGC -<span class="hljs-string"><span class="hljs-string">XX:</span></span>ParallelGCThreads=<span class="hljs-number"><span class="hljs-number">20</span></span>

-<span class="hljs-string"><span class="hljs-string">XX:</span></span>+UseParallelGC：选择垃圾收集器为并行收集器。此配置仅对年轻代有效。即上述配置下，年轻代使用并发收集，而年老代仍旧使用串行收集。

-<span class="hljs-string"><span class="hljs-string">XX:</span></span>ParallelGCThreads=<span class="hljs-number"><span class="hljs-number">20</span></span>：配置并行收集器的线程数，即：同时多少个线程一起进行垃圾回收。此值最好配置与处理器数目相等。</code></pre>
<pre><code class="hljs groovy">java -Xmx3550m -Xms3550m -Xmn2g -Xss128k -<span class="hljs-string"><span class="hljs-string">XX:</span></span>+UseParallelGC -<span class="hljs-string"><span class="hljs-string">XX:</span></span>ParallelGCThreads=<span class="hljs-number"><span class="hljs-number">20</span></span> -<span class="hljs-string"><span class="hljs-string">XX:</span></span>+UseParallelOldGC

-<span class="hljs-string"><span class="hljs-string">XX:</span></span>+UseParallelOldGC：配置年老代垃圾收集方式为并行收集。JDK6<span class="hljs-number"><span class="hljs-number">.0</span></span>支持对年老代并行收集。</code></pre>
<pre><code class="hljs groovy">java -Xmx3550m -Xms3550m -Xmn2g -Xss128k -<span class="hljs-string"><span class="hljs-string">XX:</span></span>+UseParallelGC  -<span class="hljs-string"><span class="hljs-string">XX:</span></span>MaxGCPauseMillis=<span class="hljs-number"><span class="hljs-number">100</span></span>

-<span class="hljs-string"><span class="hljs-string">XX:</span></span>MaxGCPauseMillis=<span class="hljs-number"><span class="hljs-number">100</span></span>:设置每次年轻代垃圾回收的最长时间，如果无法满足此时间，JVM会自动调整年轻代大小，以满足此值。</code></pre>
<pre><code class="hljs groovy">n java -Xmx3550m -Xms3550m -Xmn2g -Xss128k -<span class="hljs-string"><span class="hljs-string">XX:</span></span>+UseParallelGC  -<span class="hljs-string"><span class="hljs-string">XX:</span></span>MaxGCPauseMillis=<span class="hljs-number"><span class="hljs-number">100</span></span> -<span class="hljs-string"><span class="hljs-string">XX:</span></span>+UseAdaptiveSizePolicy

-<span class="hljs-string"><span class="hljs-string">XX:</span></span>+UseAdaptiveSizePolicy：设置此选项后，并行收集器会自动选择年轻代区大小和相应的Survivor区比例，以达到目标系统规定的最低相应时间或者收集频率等，此值建议使用并行收集器时，一直打开。</code></pre>
<p><font color="#0099ff">响应时间优先的并发收集器</font></p>
<p>如上文所述，并发收集器主要是保证系统的响应时间，减少垃圾收集时的停顿时间。适用于应用服务器、电信领域等。</p>
<h4 id="典型配置-1">典型配置：</h4>
<pre><code class="hljs groovy">java -Xmx3550m -Xms3550m -Xmn2g -Xss128k -<span class="hljs-string"><span class="hljs-string">XX:</span></span>ParallelGCThreads=<span class="hljs-number"><span class="hljs-number">20</span></span> -<span class="hljs-string"><span class="hljs-string">XX:</span></span>+UseConcMarkSweepGC -<span class="hljs-string"><span class="hljs-string">XX:</span></span>+UseParNewGC

-<span class="hljs-string"><span class="hljs-string">XX:</span></span>+UseConcMarkSweepGC：设置年老代为并发收集。测试中配置这个以后，-<span class="hljs-string"><span class="hljs-string">XX:</span></span>NewRatio=<span class="hljs-number"><span class="hljs-number">4</span></span>的配置失效了，原因不明。所以，此时年轻代大小最好用-Xmn设置。

-<span class="hljs-string"><span class="hljs-string">XX:</span></span>+<span class="hljs-string"><span class="hljs-string">UseParNewGC:</span></span> 设置年轻代为并行收集。可与CMS收集同时使用。JDK5<span class="hljs-number"><span class="hljs-number">.0</span></span>以上，JVM会根据系统配置自行设置，所以无需再设置此值。</code></pre>
<pre><code class="hljs groovy">java -Xmx3550m -Xms3550m -Xmn2g -Xss128k -<span class="hljs-string"><span class="hljs-string">XX:</span></span>+UseConcMarkSweepGC -<span class="hljs-string"><span class="hljs-string">XX:</span></span>CMSFullGCsBeforeCompaction=<span class="hljs-number"><span class="hljs-number">5</span></span> -<span class="hljs-string"><span class="hljs-string">XX:</span></span>+UseCMSCompactAtFullCollection

-<span class="hljs-string"><span class="hljs-string">XX:</span></span>CMSFullGCsBeforeCompaction：由于并发收集器不对内存空间进行压缩、整理，所以运行一段时间以后会产生“碎片”，使得运行效率降低。此值设置运行多少次GC以后对内存空间进行压缩、整理。

-<span class="hljs-string"><span class="hljs-string">XX:</span></span>+UseCMSCompactAtFullCollection：打开对年老代的压缩。可能会影响性能，但是可以消除碎片</code></pre>
<a name="_caption_17" target="_blank"></a><a name="_caption_17"></a><h2 id="辅助信息">辅助信息</h2>
<p>JVM提供了大量命令行参数，打印信息，供调试使用。主要有以下一些：</p>
<p><font color="#0099ff">-XX:+PrintGC：</font>输出形式：[GC 118250K-&gt;113543K(130112K), 0.0094143 secs] [Full GC 121376K-&gt;10414K(130112K), 0.0650971 secs]</p>
<p><font color="#0099ff">-XX:+PrintGCDetails：</font>输出形式：[GC [DefNew: 8614K-&gt;781K(9088K), 0.0123035 secs] 118250K-&gt;113543K(130112K), 0.0124633 secs] [GC [DefNew: 8614K-&gt;8614K(9088K), 0.0000665 secs][Tenured: 112761K-&gt;10414K(121024K), 0.0433488 secs] 121376K-&gt;10414K(130112K), 0.0436268 secs]</p>
<p><font color="#0099ff">-XX:+PrintGCTimeStamps -XX:+PrintGC：</font>PrintGCTimeStamps可与上面两个混合使用<br>
输出形式：11.851: [GC 98328K-&gt;93620K(130112K), 0.0082960 secs]</p>
<p><font color="#0099ff">-XX:+PrintGCApplicationConcurrentTime：</font>打印每次垃圾回收前，程序未中断的执行时间。可与上面混合使用。输出形式：Application time: 0.5291524 seconds</p>
<p><font color="#0099ff">-XX:+PrintGCApplicationStoppedTime：</font>打印垃圾回收期间程序暂停的时间。可与上面混合使用。输出形式：Total time for which application threads were stopped: 0.0468229 seconds</p>
<p><font color="#0099ff">-XX:PrintHeapAtGC:</font> 打印GC前后的详细堆栈信息。输出形式：</p>
<p>34.702: [GC {Heap before gc invocations=7:<br>
def new generation total 55296K, used 52568K [0x1ebd0000, 0x227d0000, 0x227d0000)<br>
eden space 49152K, 99% used [0x1ebd0000, 0x21bce430, 0x21bd0000)<br>
from space 6144K, 55% used [0x221d0000, 0x22527e10, 0x227d0000)<br>
to space 6144K, 0% used [0x21bd0000, 0x21bd0000, 0x221d0000)<br>
tenured generation total 69632K, used 2696K [0x227d0000, 0x26bd0000, 0x26bd0000)<br>
the space 69632K, 3% used [0x227d0000, 0x22a720f8, 0x22a72200, 0x26bd0000)<br>
compacting perm gen total 8192K, used 2898K [0x26bd0000, 0x273d0000, 0x2abd0000)<br>
the space 8192K, 35% used [0x26bd0000, 0x26ea4ba8, 0x26ea4c00, 0x273d0000)<br>
ro space 8192K, 66% used [0x2abd0000, 0x2b12bcc0, 0x2b12be00, 0x2b3d0000)<br>
rw space 12288K, 46% used [0x2b3d0000, 0x2b972060, 0x2b972200, 0x2bfd0000)<br>
34.735: [DefNew: 52568K-&gt;3433K(55296K), 0.0072126 secs] 55264K-&gt;6615K(124928K)Heap after gc invocations=8:<br>
def new generation total 55296K, used 3433K [0x1ebd0000, 0x227d0000, 0x227d0000)<br>
eden space 49152K, 0% used [0x1ebd0000, 0x1ebd0000, 0x21bd0000)<br>
from space 6144K, 55% used [0x21bd0000, 0x21f2a5e8, 0x221d0000)<br>
to space 6144K, 0% used [0x221d0000, 0x221d0000, 0x227d0000)<br>
tenured generation total 69632K, used 3182K [0x227d0000, 0x26bd0000, 0x26bd0000)<br>
the space 69632K, 4% used [0x227d0000, 0x22aeb958, 0x22aeba00, 0x26bd0000)<br>
compacting perm gen total 8192K, used 2898K [0x26bd0000, 0x273d0000, 0x2abd0000)<br>
the space 8192K, 35% used [0x26bd0000, 0x26ea4ba8, 0x26ea4c00, 0x273d0000)<br>
ro space 8192K, 66% used [0x2abd0000, 0x2b12bcc0, 0x2b12be00, 0x2b3d0000)<br>
rw space 12288K, 46% used [0x2b3d0000, 0x2b972060, 0x2b972200, 0x2bfd0000)<br>
}<br>
, 0.0757599 secs]</p>
<p><font color="#0099ff">-Xloggc:filename:</font>与上面几个配合使用，把相关日志信息记录到文件以便分析。</p>
<a name="_caption_18" target="_blank"></a><a name="_caption_18"></a><h2 id="常见配置汇总">常见配置汇总</h2>
<p><font color="#0099ff">堆设置</font><br>
-Xms:初始堆大小<br>
-Xmx:最大堆大小<br>
-XX:NewSize=n:设置年轻代大小<br>
-XX:NewRatio=n:设置年轻代和年老代的比值。如:为3，表示年轻代与年老代比值为1：3，年轻代占整个年轻代年老代和的1/4<br>
-XX:SurvivorRatio=n:年轻代中Eden区与两个Survivor区的比值。注意Survivor区有两个。如：3，表示Eden：Survivor=3：2，一个Survivor区占整个年轻代的1/5<br>
-XX:MaxPermSize=n:设置持久代大小</p>
<p><font color="#0099ff">收集器设置</font><br>
-XX:+UseSerialGC:设置串行收集器<br>
-XX:+UseParallelGC:设置并行收集器<br>
-XX:+UseParalledlOldGC:设置并行年老代收集器<br>
-XX:+UseConcMarkSweepGC:设置并发收集器</p>
<p><font color="#0099ff">垃圾回收统计信息</font><br>
-XX:+PrintGC<br>
-XX:+PrintGCDetails<br>
-XX:+PrintGCTimeStamps<br>
-Xloggc:filename</p>
<p><font color="#0099ff">并行收集器设置</font><br>
-XX:ParallelGCThreads=n:设置并行收集器收集时使用的CPU数。并行收集线程数。<br>
-XX:MaxGCPauseMillis=n:设置并行收集最大暂停时间<br>
-XX:GCTimeRatio=n:设置垃圾回收时间占程序运行时间的百分比。公式为1/(1+n)</p>
<p><font color="#0099ff">并发收集器设置</font><br>
-XX:+CMSIncrementalMode:设置为增量模式。适用于单CPU情况。<br>
-XX:ParallelGCThreads=n:设置并发收集器年轻代收集方式为并行收集时，使用的CPU数。并行收集线程数。</p>
<a name="_caption_19" target="_blank"></a><a name="_caption_19"></a><h2 id="调优总结">调优总结</h2>
<p><font color="#0099ff">年轻代大小选择</font></p>
<p><font color="#c7254e">响应时间优先的应用</font>：<font color="#c7254e">尽可能设大，直到接近系统的最低响应时间限制（根据实际情况选择）。</font>在此种情况下，年轻代收集发生的频率也是最小的。同时，减少到达年老代的对象。</p>
<p><font color="#c7254e">吞吐量优先的应用</font>：尽可能的设置大，可能到达Gbit的程度。因为对响应时间没有要求，垃圾收集可以并行进行，一般适合8CPU以上的应用。</p>
<p><font color="#0099ff">年老代大小选择</font></p>
<p>响应时间优先的应用：年老代使用并发收集器，所以其大小需要小心设置，一般要考虑并发会话率和会话持续时间等一些参数。如果堆设置小了，可以会造成内存碎片、高回收频率以及应用暂停而使用传统的标记清除方式；如果堆大了，则需要较长的收集时间。最优化的方案，一般需要参考以下数据获得：</p>
<ol>
<li>并发垃圾收集信息</li>
<li>持久代并发收集次数</li>
<li>传统GC信息</li>
<li>花在年轻代和年老代回收上的时间比例<br>
减少年轻代和年老代花费的时间，一般会提高应用的效率</li>
</ol>
<p><font color="#0099ff">吞吐量优先的应用</font></p>
<p>一般吞吐量优先的应用都有一个很大的年轻代和一个较小的年老代。原因是，这样可以尽可能回收掉大部分短期对象，减少中期的对象，而年老代尽存放长期存活对象。</p>
<p><font color="#0099ff">较小堆引起的碎片问题</font></p>
<p>因为年老代的并发收集器使用标记、清除算法，所以不会对堆进行压缩。当收集器回收时，他会把相邻的空间进行合并，这样可以分配给较大的对象。但是，当堆空间较小时，运行一段时间以后，就会出现“碎片”，如果并发收集器找不到足够的空间，那么并发收集器将会停止，然后使用传统的标记、清除方式进行回收。如果出现“碎片”，可能需要进行如下配置：<br>
1. <font color="#c7254e">-XX:+UseCMSCompactAtFullCollection</font>：使用并发收集器时，开启对年老代的压缩。<br>
2. <font color="#c7254e">-XX:CMSFullGCsBeforeCompaction=0</font>：上面配置开启的情况下，这里设置多少次Full GC后，对年老代进行压缩</p>
<a name="_caption_20" target="_blank"></a><a name="_caption_20"></a><h2 id="垃圾回收的瓶颈">垃圾回收的瓶颈</h2>
<p>传统分代垃圾回收方式，已经在一定程度上把垃圾回收给应用带来的负担降到了最小，把应用的吞吐量推到了一个极限。但是他无法解决的一个问题，就是Full GC所带来的应用暂停。在一些对实时性要求很高的应用场景下，GC暂停所带来的请求堆积和请求失败是无法接受的。这类应用可能要求请求的返回时间在几百甚至几十毫秒以内，如果分代垃圾回收方式要达到这个指标，只能把最大堆的设置限制在一个相对较小范围内，但是这样有限制了应用本身的处理能力，同样也是不可接收的。</p>
<p>分代垃圾回收方式确实也考虑了实时性要求而提供了并发回收器，支持最大暂停时间的设置，但是受限于分代垃圾回收的内存划分模型，其效果也不是很理想。</p>
<p>为了达到实时性的要求（其实Java语言最初的设计也是在嵌入式系统上的），一种新垃圾回收方式呼之欲出，它既支持短的暂停时间，又支持大的内存空间分配。可以很好的解决传统分代方式带来的问题。</p>
<a name="_caption_21" target="_blank"></a><a name="_caption_21"></a><h2 id="增量收集的演进">增量收集的演进</h2>
<p>增量收集的方式在理论上可以解决传统分代方式带来的问题。增量收集把对堆空间划分成一系列内存块，使用时，先使用其中一部分（不会全部用完），垃圾收集时把之前用掉的部分中的存活对象再放到后面没有用的空间中，这样可以实现一直边使用边收集的效果，避免了传统分代方式整个使用完了再暂停的回收的情况。</p>
<p>当然，传统分代收集方式也提供了并发收集，但是他有一个很致命的地方，就是把整个堆做为一个内存块，这样一方面会造成碎片（无法压缩），另一方面他的每次收集都是对整个堆的收集，无法进行选择，在暂停时间的控制上还是很弱。而增量方式，通过内存空间的分块，恰恰可以解决上面问题。</p>
<a name="_caption_22" target="_blank"></a><a name="_caption_22"></a><h2 id="garbage-firestg1">Garbage Firest（G1）</h2>
<p>这部分的内容主要参考<a href="http://www.blogjava.net/BlueDavy/archive/2009/03/11/259230.html" target="_blank"><font color="#0099ff">这里</font></a>，这篇文章算是对G1算法论文的解读。我也没加什么东西了。</p>
<p><font color="#0099ff">目标</font></p>
<p>从设计目标看G1完全是为了大型应用而准备的。</p>
<pre><code class="hljs lua">支持很大的堆
高吞吐量
  <span class="hljs-comment"><span class="hljs-comment">--支持多CPU和垃圾回收线程</span></span>
  <span class="hljs-comment"><span class="hljs-comment">--在主线程暂停的情况下，使用并行收集</span></span>
  <span class="hljs-comment"><span class="hljs-comment">--在主线程运行的情况下，使用并发收集</span></span>
实时目标：可配置在N毫秒内最多只占用M毫秒的时间进行垃圾回收</code></pre>
<p>当然G1要达到实时性的要求，相对传统的分代回收算法，在性能上会有一些损失。</p>
<p><font color="#0099ff">算法详解</font></p>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning014.png" title="JVM Tuning 014"></p>
<p>G1可谓博采众家之长，力求到达一种完美。他吸取了增量收集优点，把整个堆划分为一个一个等大小的区域（region）。内存的回收和划分都以region为单位；同时，他也吸取了CMS的特点，把这个垃圾回收过程分为几个阶段，分散一个垃圾回收过程；而且，G1也认同分代垃圾回收的思想，认为不同对象的生命周期不同，可以采取不同收集方式，因此，它也支持分代的垃圾回收。为了达到对回收时间的可预计性，G1在扫描了region以后，对其中的活跃对象的大小进行排序，首先会收集那些活跃对象小的region，以便快速回收空间（要复制的活跃对象少了），因为活跃对象小，里面可以认为多数都是垃圾，所以这种方式被称为Garbage First（G1）的垃圾回收算法，即：垃圾优先的回收。</p>
<h4 id="回收步骤">回收步骤：</h4>
<h4 id="初始标记initial-marking">初始标记（Initial Marking）</h4>
<p>G1对于每个region都保存了两个标识用的bitmap，一个为previous marking bitmap，一个为next marking bitmap，bitmap中包含了一个bit的地址信息来指向对象的起始点。</p>
<p>开始Initial Marking之前，首先并发的清空next marking bitmap，然后停止所有应用线程，并扫描标识出每个region中root可直接访问到的对象，将region中top的值放入next top at mark start（TAMS）中，之后恢复所有应用线程。</p>
<p>触发这个步骤执行的条件为：</p>
<pre><code class="hljs verilog">G1定义了一个JVM Heap大小的百分比的阀值，称为h，另外还有一个H，H的值为(<span class="hljs-number"><span class="hljs-number">1</span></span>-h)*Heap Size，目前这个h的值是固定的，后续G1也许会将其改为动态的，根据jvm的运行情况来动态的调整，在分代方式下，G1还定义了一个u以及<span class="hljs-keyword"><span class="hljs-keyword">soft</span></span> limit，<span class="hljs-keyword"><span class="hljs-keyword">soft</span></span> limit的值为H-u*Heap Size，当Heap中使用的内存超过了<span class="hljs-keyword"><span class="hljs-keyword">soft</span></span> limit值时，就会在一次clean up执行完毕后在应用允许的GC暂停时间范围内尽快的执行此步骤；

在<span class="hljs-keyword"><span class="hljs-keyword">pure</span></span>方式下，G1将marking与clean up组成一个环，以便clean up能充分的使用marking的信息，当clean up开始回收时，首先回收能够带来最多内存空间的regions，当经过多次的clean up，回收到没多少空间的regions时，G1重新初始化一个新的marking与clean up构成的环。</code></pre>
<h4 id="并发标记concurrent-marking">并发标记（Concurrent Marking）</h4>
<p>按照之前Initial Marking扫描到的对象进行遍历，以识别这些对象的下层对象的活跃状态，对于在此期间应用线程并发修改的对象的以来关系则记录到remembered set logs中，新创建的对象则放入比top值更高的地址区间中，这些新创建的对象默认状态即为活跃的，同时修改top值。</p>
<h4 id="最终标记暂停final-marking-pause">最终标记暂停（Final Marking Pause）</h4>
<p>当应用线程的remembered set logs未满时，是不会放入filled RS buffers中的，在这样的情况下，这些remebered set logs中记录的card的修改就会被更新了，因此需要这一步，这一步要做的就是把应用线程中存在的remembered set logs的内容进行处理，并相应的修改remembered sets，这一步需要暂停应用，并行的运行。</p>
<h4 id="存活对象计算及清除live-data-counting-and-cleanup">存活对象计算及清除（Live Data Counting and Cleanup）</h4>
<p>值得注意的是，在G1中，并不是说Final Marking Pause执行完了，就肯定执行Cleanup这步的，由于这步需要暂停应用，G1为了能够达到准实时的要求，需要根据用户指定的最大的GC造成的暂停时间来合理的规划什么时候执行Cleanup，另外还有几种情况也是会触发这个步骤的执行的：</p>
<pre><code class="hljs vbscript">G1采用的是复制方法来进行收集，必须保证每次的”<span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-built_in"><span class="hljs-built_in">space</span></span>”的空间都是够的，因此G1采取的策略是当已经使用的内存空间达到了H时，就执行Cleanup这个步骤；

对于full-young和partially-young的分代模式的G1而言，则还有情况会触发Cleanup的执行，full-young模式下，G1根据应用可接受的暂停时间、回收young regions需要消耗的时间来估算出一个yound regions的数量值，当JVM中分配对象的young regions的数量达到此值时，Cleanup就会执行；partially-young模式下，则会尽量频繁的在应用可接受的暂停时间范围内执行Cleanup，并最大限度的去执行non-young regions的Cleanup。</code></pre>
<a name="_caption_23" target="_blank"></a><a name="_caption_23"></a><h2 id="展望">展望</h2>
<p>以后JVM的调优或许跟多需要针对G1算法进行调优了。</p>
<a name="_caption_24" target="_blank"></a><a name="_caption_24"></a><h2 id="jvm调优工具">JVM调优工具</h2>
<h4 id="jconsolejprofilevisualvm">Jconsole，jProfile，VisualVM</h4>
<h4 id="jconsole-jdk自带功能简单但是可以在系统有一定负荷的情况下使用对垃圾回收算法有很详细的跟踪">Jconsole : jdk自带，功能简单，但是可以在系统有一定负荷的情况下使用。对垃圾回收算法有很详细的跟踪。</h4>
<h4 id="jprofiler商业软件需要付费功能强大">JProfiler：商业软件，需要付费。功能强大。</h4>
<h4 id="visualvmjdk自带功能强大与jprofiler类似推荐">VisualVM：JDK自带，功能强大，与JProfiler类似。推荐。</h4>
<a name="_caption_25" target="_blank"></a><a name="_caption_25"></a><h2 id="如何调优">如何调优</h2>
<p>观察内存释放情况、集合类检查、对象树</p>
<p>上面这些调优工具都提供了强大的功能，但是总的来说一般分为以下几类功能</p>
<p><font color="#0099ff">堆信息查看</font></p>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning015.png" title="JVM Tuning 015"></p>
<pre><code class="hljs">可查看堆空间大小分配（年轻代、年老代、持久代分配）
提供即时的垃圾回收功能
垃圾监控（长时间监控回收情况）</code></pre>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning016.png" title="JVM Tuning 016"></p>
<pre><code class="hljs">查看堆内类、对象信息查看：数量、类型等</code></pre>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning017.png" title="JVM Tuning 017"></p>
<pre><code class="hljs">对象引用情况查看</code></pre>
<p>有了堆信息查看方面的功能，我们一般可以顺利解决以下问题：</p>
<ul>
<li>年老代年轻代大小划分是否合理</li>
<li>内存泄漏</li>
<li>垃圾回收算法设置是否合理</li>
</ul>
<a name="_caption_26" target="_blank"></a><a name="_caption_26"></a><h2 id="线程监控">线程监控</h2>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning018.png" title="JVM Tuning 018"></p>
<pre><code class="hljs">线程信息监控：系统线程数量。
线程状态监控：各个线程都处在什么样的状态下</code></pre>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning019.png" title="JVM Tuning 019"></p>
<pre><code class="hljs">Dump线程详细信息：查看线程内部运行情况
死锁检查</code></pre>
<p><font color="#0099ff">热点分析</font></p>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning020.png" title="JVM Tuning 020"></p>
<h4 id="cpu热点检查系统哪些方法占用的大量cpu时间">CPU热点：检查系统哪些方法占用的大量CPU时间</h4>
<h4 id="内存热点检查哪些对象在系统中数量最大一定时间内存活对象和销毁对象一起统计">内存热点：检查哪些对象在系统中数量最大（一定时间内存活对象和销毁对象一起统计）</h4>
<p>这两个东西对于系统优化很有帮助。我们可以根据找到的热点，有针对性的进行系统的瓶颈查找和进行系统优化，而不是漫无目的的进行所有代码的优化。</p>
<p><font color="#0099ff">快照</font><br>
快照是系统运行到某一时刻的一个定格。在我们进行调优的时候，不可能用眼睛去跟踪所有系统变化，依赖快照功能，我们就可以进行系统两个不同运行时刻，对象（或类、线程等）的不同，以便快速找到问题</p>
<p>举例说，我要检查系统进行垃圾回收以后，是否还有该收回的对象被遗漏下来的了。那么，我可以在进行垃圾回收前后，分别进行一次堆情况的快照，然后对比两次快照的对象情况。</p>
<a name="_caption_27" target="_blank"></a><a name="_caption_27"></a><h2 id="内存泄漏检查">内存泄漏检查</h2>
<p>内存泄漏是比较常见的问题，而且解决方法也比较通用，这里可以重点说一下，而线程、热点方面的问题则是具体问题具体分析了。</p>
<p>内存泄漏一般可以理解为系统资源（各方面的资源，堆、栈、线程等）在错误使用的情况下，导致使用完毕的资源无法回收（或没有回收），从而导致新的资源分配请求无法完成，引起系统错误。</p>
<p>内存泄漏对系统危害比较大，因为他可以直接导致系统的崩溃。</p>
<p>需要区别一下，内存泄漏和系统超负荷两者是有区别的，虽然可能导致的最终结果是一样的。内存泄漏是用完的资源没有回收引起错误，而系统超负荷则是系统确实没有那么多资源可以分配了（其他的资源都在使用）。</p>
<p><font color="#0099ff">年老代堆空间被占满</font></p>
<h4 id="异常-java.lang.outofmemoryerror-java-heap-space">异常： java.lang.OutOfMemoryError: Java heap space</h4>
<h4 id="说明">说明：</h4>
<p><img src="./JVM调优总结_files/o_Jvm_Tuning021.png" title="JVM Tuning 021"></p>
<p>这是最典型的内存泄漏方式，简单说就是所有堆空间都被无法回收的垃圾对象占满，虚拟机无法再在分配新空间。<br>
如上图所示，这是非常典型的内存泄漏的垃圾回收情况图。所有峰值部分都是一次垃圾回收点，所有谷底部分表示是一次垃圾回收后剩余的内存。连接所有谷底的点，可以发现一条由底到高的线，这说明，随时间的推移，系统的堆空间被不断占满，最终会占满整个堆空间。因此可以初步认为系统内部可能有内存泄漏。（上面的图仅供示例，在实际情况下收集数据的时间需要更长，比如几个小时或者几天）</p>
<h4 id="解决">解决：</h4>
<p>这种方式解决起来也比较容易，一般就是根据垃圾回收前后情况对比，同时根据对象引用情况（常见的集合对象引用）分析，基本都可以找到泄漏点。</p>
<p><font color="#0099ff">持久代被占满</font></p>
<h4 id="异常java.lang.outofmemoryerror-permgen-space">异常：java.lang.OutOfMemoryError: PermGen space</h4>
<h4 id="说明-1">说明：</h4>
<p>Perm空间被占满。无法为新的class分配存储空间而引发的异常。这个异常以前是没有的，但是在Java反射大量使用的今天这个异常比较常见了。主要原因就是大量动态反射生成的类不断被加载，最终导致Perm区被占满。</p>
<p>更可怕的是，不同的classLoader即便使用了相同的类，但是都会对其进行加载，相当于同一个东西，如果有N个classLoader那么他将会被加载N次。因此，某些情况下，这个问题基本视为无解。当然，存在大量classLoader和大量反射类的情况其实也不多。<br>
解决：</p>
<ol>
<li>-XX:MaxPermSize=16m</li>
<li>换用JDK。比如JRocket。</li>
</ol>
<p><font color="#0099ff">堆栈溢出</font></p>
<h4 id="异常java.lang.stackoverflowerror">异常：java.lang.StackOverflowError</h4>
<h4 id="说明这个就不多说了一般就是递归没返回或者循环调用造成">说明：这个就不多说了，一般就是递归没返回，或者循环调用造成</h4>
<p><font color="#0099ff">线程堆栈满</font></p>
<h4 id="异常fatal-stack-size-too-small">异常：Fatal: Stack size too small</h4>
<h4 id="说明java中一个线程的空间大小是有限制的jdk5.0以后这个值是1m与这个线程相关的数据将会保存在其中但是当线程空间满了以后将会出现上面异常">说明：java中一个线程的空间大小是有限制的。JDK5.0以后这个值是1M。与这个线程相关的数据将会保存在其中。但是当线程空间满了以后，将会出现上面异常。</h4>
<h4 id="解决增加线程栈大小-xss2m但这个配置无法解决根本问题还要看代码部分是否有造成泄漏的部分">解决：增加线程栈大小。-Xss2m。但这个配置无法解决根本问题，还要看代码部分是否有造成泄漏的部分。</h4>
<p><font color="#0099ff">系统内存被占满</font></p>
<h4 id="异常java.lang.outofmemoryerror-unable-to-create-new-native-thread">异常：java.lang.OutOfMemoryError: unable to create new native thread</h4>
<h4 id="说明-2">说明：</h4>
<p>这个异常是由于操作系统没有足够的资源来产生这个线程造成的。系统创建线程时，除了要在Java堆中分配内存外，操作系统本身也需要分配资源来创建线程。因此，当线程数量大到一定程度以后，堆中或许还有空间，但是操作系统分配不出资源来了，就出现这个异常了。</p>
<p>分配给Java虚拟机的内存愈多，系统剩余的资源就越少，因此，当系统内存固定时，分配给Java虚拟机的内存越多，那么，系统总共能够产生的线程也就越少，两者成反比的关系。同时，可以通过修改-Xss来减少分配给单个线程的空间，也可以增加系统总共内生产的线程数。</p>
<h4 id="解决-1">解决：</h4>
<ol>
<li>重新设计系统减少线程数量。</li>
<li>线程数量不能减少的情况下，通过-Xss减小单个线程大小。以便能生产更多的线程。</li>
</ol>
<a name="_caption_28" target="_blank"></a><a name="_caption_28"></a><h2 id="垃圾回收的悖论">垃圾回收的悖论</h2>
<p>所谓“成也萧何败萧何”。Java的垃圾回收确实带来了很多好处，为开发带来了便利。但是在一些高性能、高并发的情况下，垃圾回收确成为了制约Java应用的瓶颈。目前JDK的垃圾回收算法，始终无法解决垃圾回收时的暂停问题，因为这个暂停严重影响了程序的相应时间，造成拥塞或堆积。这也是后续JDK增加G1算法的一个重要原因。</p>
<p>当然，上面是从技术角度出发解决垃圾回收带来的问题，但是从系统设计方面我们就需要问一下了：</p>
<pre><code class="hljs">我们需要分配如此大的内存空间给应用吗？
我们是否能够通过有效使用内存而不是通过扩大内存的方式来设计我们的系统呢？ </code></pre>
<a name="_caption_29" target="_blank"></a><a name="_caption_29"></a><h2 id="我们的内存中都放了什么">我们的内存中都放了什么</h2>
<p>内存中需要放什么呢？个人认为，内存中需要放的是你的应用需要在不久的将来再次用到到的东西。想想看，如果你在将来不用这些东西，何必放内存呢？放文件、数据库不是更好？这些东西一般包括：</p>
<ol>
<li>系统运行时业务相关的数据。比如web应用中的session、即时消息的session等。这些数据一般在一个用户访问周期或者一个使用过程中都需要存在。</li>
<li>缓存。缓存就比较多了，你所要快速访问的都可以放这里面。其实上面的业务数据也可以理解为一种缓存。</li>
<li>线程。</li>
</ol>
<p>因此，我们是不是可以这么认为，如果我们不把业务数据和缓存放在JVM中，或者把他们独立出来，那么Java应用使用时所需的内存将会大大减少，同时垃圾回收时间也会相应减少。</p>
<p>我认为这是可能的。</p>
<a name="_caption_30" target="_blank"></a><a name="_caption_30"></a><h2 id="解决之道">解决之道</h2>
<p><font color="#0099ff">数据库、文件系统</font></p>
<p>把所有数据都放入数据库或者文件系统，这是一种最为简单的方式。在这种方式下，Java应用的内存基本上等于处理一次峰值并发请求所需的内存。数据的获取都在每次请求时从数据库和文件系统中获取。也可以理解为，一次业务访问以后，所有对象都可以进行回收了。</p>
<p>这是一种内存使用最有效的方式，但是从应用角度来说，这种方式很低效。</p>
<p><font color="#0099ff">内存-硬盘映射</font></p>
<p>上面的问题是因为我们使用了文件系统带来了低效。但是如果我们不是读写硬盘，而是写内存的话效率将会提高很多。</p>
<p>数据库和文件系统都是实实在在进行了持久化，但是当我们并不需要这样持久化的时候，我们可以做一些变通——把内存当硬盘使。</p>
<p>内存-硬盘映射很好很强大，既用了缓存又对Java应用的内存使用又没有影响。Java应用还是Java应用，他只知道读写的还是文件，但是实际上是内存。</p>
<p>这种方式兼得的Java应用与缓存两方面的好处。memcached的广泛使用也正是这一类的代表。</p>
<p><font color="#0099ff">同一机器部署多个JVM</font></p>
<p>这也是一种很好的方式，可以分为纵拆和横拆。纵拆可以理解为把Java应用划分为不同模块，各个模块使用一个独立的Java进程。而横拆则是同样功能的应用部署多个JVM。</p>
<p>通过部署多个JVM，可以把每个JVM的内存控制一个垃圾回收可以忍受的范围内即可。但是这相当于进行了分布式的处理，其额外带来的复杂性也是需要评估的。另外，也有支持分布式的这种JVM可以考虑，不要要钱哦：）</p>
<p><font color="#0099ff">程序控制的对象生命周期</font><br>
这种方式是理想当中的方式，目前的虚拟机还没有，纯属假设。即：考虑由编程方式配置哪些对象在垃圾收集过程中可以直接跳过，减少垃圾回收线程遍历标记的时间。</p>
<p>这种方式相当于在编程的时候告诉虚拟机某些对象你可以在*时间后在进行收集或者由代码标识可以收集了（类似C、C++），在这之前你即便去遍历他也是没有效果的，他肯定是还在被引用的。</p>
<p>这种方式如果JVM可以实现，个人认为将是一个飞跃，Java即有了垃圾回收的优势，又有了C、C++对内存的可控性。</p>
<p><font color="#0099ff">线程分配</font></p>
<p>Java的阻塞式的线程模型基本上可以抛弃了，目前成熟的NIO框架也比较多了。阻塞式IO带来的问题是线程数量的线性增长，而NIO则可以转换成为常数线程。因此，对于服务端的应用而言，NIO还是唯一选择。不过，JDK7中为我们带来的AIO是否能让人眼前一亮呢？我们拭目以待。</p>
<p><font color="#0099ff">其他的JDK</font></p>
<p>本文说的都是Sun的JDK，目前常见的JDK还有JRocket和IBM的JDK。其中JRocket在IO方面比Sun的高很多，不过Sun JDK6.0以后提高也很大。而且JRocket在垃圾回收方面，也具有优势，其可设置垃圾回收的最大暂停时间也是很吸引人的。不过，系统Sun的G1实现以后，在这方面会有一个质的飞跃。</p>
<pre><code class="hljs">能整理出上面一些东西，也是因为站在巨人的肩上。下面是一些参考资料，供大家学习，大家有更好的，可以继续完善：）</code></pre>
<p>· <a href="http://www.ibm.com/developerworks/cn/java/j-jtp10283/" target="_blank">Java 理论与实践: 垃圾收集简史</a></p>
<p>· 《深入Java虚拟机》。虽然过去了很多年，但这本书依旧是经典。</p>
<p>这里是本系列的最后一篇了，很高兴大家能够喜欢这系列的文章。期间也提了很多问题，其中有些是我之前没有想到的或者考虑欠妥的，感谢提出这些问题的朋友，我也学到的不少东西。</p>
</div><div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="BlogPostCategory">分类: <a href="https://www.cnblogs.com/andy-zhou/category/806120.html" target="_blank">JVM</a></div>
<div id="EntryTag"></div>
<div id="blog_post_info"><div id="green_channel">
        <a href="javascript:void(0);" id="green_channel_digg" onclick="DiggIt(5327288,cb_blogId,1);green_channel_success(this,&#39;谢谢推荐！&#39;);">好文要顶</a>
            <a id="green_channel_follow" onclick="follow(&#39;acf1618f-9162-e511-b908-9dcfd8948a71&#39;);" href="javascript:void(0);">关注我</a>
    <a id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;" href="javascript:void(0);">收藏该文</a>
    <a id="green_channel_weibo" href="javascript:void(0);" title="分享至新浪微博" onclick="ShareToTsina()"><img src="./JVM调优总结_files/icon_weibo_24.png" alt=""></a>
    <a id="green_channel_wechat" href="javascript:void(0);" title="分享至微信" onclick="shareOnWechat()"><img src="./JVM调优总结_files/wechat.png" alt=""></a>
</div>
<div id="author_profile">
    <div id="author_profile_info" class="author_profile_info">
            <a href="http://home.cnblogs.com/u/andy-zhou/" target="_blank"><img src="./JVM调优总结_files/20150924161502.png" class="author_avatar" alt=""></a>
        <div id="author_profile_detail" class="author_profile_info">
            <a href="http://home.cnblogs.com/u/andy-zhou/">Andrew.Zhou</a><br>
            <a href="http://home.cnblogs.com/u/andy-zhou/followees">关注 - 6</a><br>
            <a href="http://home.cnblogs.com/u/andy-zhou/followers">粉丝 - 191</a>
        </div>
    </div>
    <div class="clear"></div>
    <div id="author_profile_honor"></div>
    <div id="author_profile_follow">
                <a href="javascript:void(0);" onclick="follow(&#39;acf1618f-9162-e511-b908-9dcfd8948a71&#39;);return false;">+加关注</a>
    </div>
</div>
<div id="div_digg">
    <div class="diggit" onclick="votePost(5327288,&#39;Digg&#39;)">
        <span class="diggnum" id="digg_count">17</span>
    </div>
    <div class="buryit" onclick="votePost(5327288,&#39;Bury&#39;)">
        <span class="burynum" id="bury_count">1</span>
    </div>
    <div class="clear"></div>
    <div class="diggword" id="digg_tips">
    </div>
</div>
<script type="text/javascript">
    currentDiggType = 0;
</script></div>
<div class="clear"></div>
<div id="post_next_prev"><a href="https://www.cnblogs.com/andy-zhou/p/5326897.html" class="p_n_p_prefix">« </a> 上一篇：<a href="https://www.cnblogs.com/andy-zhou/p/5326897.html" title="发布于2016-03-27 21:26">Markdown 语法说明</a><br><a href="https://www.cnblogs.com/andy-zhou/p/5327596.html" class="p_n_p_prefix">» </a> 下一篇：<a href="https://www.cnblogs.com/andy-zhou/p/5327596.html" title="发布于2016-03-28 01:40">如何精确地测量java对象的大小-底层instrument API</a><br></div>
</div>


		</div>
		<div class="postDesc">posted @ <span id="post-date">2016-03-27 23:01</span> <a href="https://www.cnblogs.com/andy-zhou/">Andrew.Zhou</a> 阅读(<span id="post_view_count">40962</span>) 评论(<span id="post_comment_count">4</span>)  <a href="https://i.cnblogs.com/EditPosts.aspx?postid=5327288" rel="nofollow">编辑</a> <a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#" onclick="AddToWz(5327288);return false;">收藏</a></div>
	</div>
	<script src="./JVM调优总结_files/highlight.min.js.下载"></script><script>markdown_highlight();</script><script type="text/javascript">var allowComments=true,cb_blogId=246678,cb_entryId=5327288,cb_blogApp=currentBlogApp,cb_blogUserGuid='acf1618f-9162-e511-b908-9dcfd8948a71',cb_entryCreatedDate='2016/3/27 23:01:00';loadViewCount(cb_entryId);var cb_postType=1;var isMarkdown=true;</script>
	
</div><!--end: topics 文章、评论容器-->
</div><a name="!comments"></a><div id="blog-comments-placeholder"><div style="color:green;margin:50px 0;font-weight:bold;">努力加载评论中...</div></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div id="comment_form" class="commentform">
<a name="commentform"></a>
<div id="divCommentShow"></div>
<div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server" clientidmode="Static">刷新评论</a><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#" onclick="return RefreshPage();">刷新页面</a><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#top">返回顶部</a></div>
<div id="comment_form_container"><div class="login_tips">注册用户登录后才能发表评论，请 <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return login(&#39;commentform&#39;);">登录</a> 或 <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return register();">注册</a>，<a href="http://www.cnblogs.com/">访问</a>网站首页。</div></div>
<div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
<div id="ad_t2"><a href="https://edu.51cto.com/activity/19.html?source=bky" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-51CTO&#39;)">【幸运】99%的人不知道我们有可以帮你薪资翻倍的秘笈！</a><br><a href="http://www.ucancode.com/index.htm" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-工控&#39;)">【推荐】超50万C++/C#源码: 大型实时仿真组态图形源码</a><br><a href="https://cloud.baidu.com/campaign/purchase-2019/index.html?track=cp:dsp|pf:pc|pp:chui-bokeyuan-huodong-19caigouji-BCC-neiyeCH-190311|pu:neiyeCH-wenzilian|ci:2019cgj|kw:2105959" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-百度云&#39;)">【推荐】百度云“猪”你开年行大运，红包疯狂拿</a><br><a href="https://ke.qq.com/adActivity.html?name=xiangxueketang2" target="_blank" onclick="ga(&#39;send&#39;, &#39;event&#39;, &#39;Link&#39;, &#39;click&#39;, &#39;T2-享学&#39;)">【推荐】55K刚面完Java架构师岗，这些技术你必须掌握</a><br></div>
<div id="opt_under_post"></div>
<script async="async" src="./JVM调优总结_files/gpt.js.下载"></script>
<script>
  var googletag = googletag || {};
  googletag.cmd = googletag.cmd || [];
</script>
<script>
  googletag.cmd.push(function() {
        googletag.defineSlot('/1090369/C1', [300, 250], 'div-gpt-ad-1546353474406-0').addService(googletag.pubads());
        googletag.defineSlot('/1090369/C2', [468, 60], 'div-gpt-ad-1539008685004-0').addService(googletag.pubads());
        googletag.pubads().enableSingleRequest();
        googletag.enableServices();
  });
</script>
<div id="cnblogs_c1" class="c_ad_block">
    <div id="div-gpt-ad-1546353474406-0" style="height:250px; width:300px;"></div>
</div>
<div id="under_post_news" style="display: none;"><div class="itnews c_ad_block"><b>相关博文：</b><br>·  <a href="https://www.cnblogs.com/Jtianlin/p/5235171.html" target="_blank" onclick="clickRecomItmem(5235171)">JVM总结</a><br>·  <a href="https://www.cnblogs.com/joeylee97/p/8557056.html" target="_blank" onclick="clickRecomItmem(8557056)">JVM 总结</a><br>·  <a href="https://www.cnblogs.com/juanjuankaikai/p/9299310.html" target="_blank" onclick="clickRecomItmem(9299310)">JVM总结</a><br>·  <a href="https://www.cnblogs.com/ldy-blogs/p/9013249.html" target="_blank" onclick="clickRecomItmem(9013249)">JVM总结</a><br>·  <a href="https://www.cnblogs.com/midiyu/p/7906663.html" target="_blank" onclick="clickRecomItmem(7906663)">JVM总结</a><br></div></div>
<div id="cnblogs_c2" class="c_ad_block">
    <div id="div-gpt-ad-1539008685004-0" style="height:60px; width:468px;"></div>
</div>
<div id="under_post_kb"><div class="itnews c_ad_block"><b>最新新闻</b>：<br> ·  <a href="https://news.cnblogs.com/n/622271/" target="_blank">“夸夸群”火得快也凉得快 发起人：四五天就夸腻了</a><br> ·  <a href="https://news.cnblogs.com/n/622270/" target="_blank">别光盯着苹果新品，亚马逊新Kindle也来了</a><br> ·  <a href="https://news.cnblogs.com/n/622269/" target="_blank">重罚谷歌后 欧盟反垄断目标或瞄准苹果亚马逊</a><br> ·  <a href="https://news.cnblogs.com/n/622268/" target="_blank">科技股收盘｜中概股普跌 老虎证券上市首日大涨36.5%</a><br> ·  <a href="https://news.cnblogs.com/n/622267/" target="_blank">电商竞争白热化之际 沃尔玛首席技术官突然离职</a><br>» <a href="http://news.cnblogs.com/" title="IT新闻" target="_blank">更多新闻...</a></div></div>
<div id="HistoryToday" class="c_ad_block"></div>
<script type="text/javascript">
 if(enablePostBottom()) {
    codeHighlight();
    fixPostBody();
    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
    deliverT2();
    deliverC1();
    deliverC2();    
    loadNewsAndKb();
    loadBlogSignature();
    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate, cb_postType);
    loadOptUnderPost();
    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);  
}
</script>
</div>

    
	</div><!--end: topicList 文章列表容器-->

	<div id="sideBar">
		<div id="sideBarMain">
			
<!--done-->
<div class="newsItem">
<h3 class="catListTitle">公告</h3>
	<div id="blog-news"><div id="profile_block">昵称：<a href="https://home.cnblogs.com/u/andy-zhou/">Andrew.Zhou</a><br>园龄：<a href="https://home.cnblogs.com/u/andy-zhou/" title="入园时间：2015-09-24">3年5个月</a><br>粉丝：<a href="https://home.cnblogs.com/u/andy-zhou/followers/">191</a><br>关注：<a href="https://home.cnblogs.com/u/andy-zhou/followees/">6</a><div id="p_b_follow"><a href="javascript:void(0);" onclick="follow(&#39;acf1618f-9162-e511-b908-9dcfd8948a71&#39;)">+加关注</a></div><script>getFollowStatus('acf1618f-9162-e511-b908-9dcfd8948a71')</script></div></div><script type="text/javascript">loadBlogNews();</script>
</div>

			<div id="calendar"><div id="blog-calendar" style=""><table id="blogCalendar" class="Cal" cellspacing="0" cellpadding="0" title="Calendar">
	<tbody><tr><td colspan="7"><table class="CalTitle" cellspacing="0">
		<tbody><tr><td class="CalNextPrev"><a href="javascript:void(0);" onclick="loadBlogCalendar(&#39;2019/02/01&#39;);return false;">&lt;</a></td><td align="center">2019年3月</td><td class="CalNextPrev" align="right"><a href="javascript:void(0);" onclick="loadBlogCalendar(&#39;2019/04/01&#39;);return false;">&gt;</a></td></tr>
	</tbody></table></td></tr><tr><th class="CalDayHeader" align="center" abbr="日" scope="col">日</th><th class="CalDayHeader" align="center" abbr="一" scope="col">一</th><th class="CalDayHeader" align="center" abbr="二" scope="col">二</th><th class="CalDayHeader" align="center" abbr="三" scope="col">三</th><th class="CalDayHeader" align="center" abbr="四" scope="col">四</th><th class="CalDayHeader" align="center" abbr="五" scope="col">五</th><th class="CalDayHeader" align="center" abbr="六" scope="col">六</th></tr><tr><td class="CalOtherMonthDay" align="center">24</td><td class="CalOtherMonthDay" align="center">25</td><td class="CalOtherMonthDay" align="center">26</td><td class="CalOtherMonthDay" align="center">27</td><td class="CalOtherMonthDay" align="center">28</td><td align="center">1</td><td class="CalWeekendDay" align="center">2</td></tr><tr><td class="CalWeekendDay" align="center">3</td><td align="center">4</td><td align="center">5</td><td align="center">6</td><td align="center">7</td><td align="center">8</td><td class="CalWeekendDay" align="center">9</td></tr><tr><td class="CalWeekendDay" align="center">10</td><td align="center">11</td><td align="center">12</td><td align="center">13</td><td align="center">14</td><td align="center">15</td><td class="CalWeekendDay" align="center">16</td></tr><tr><td class="CalWeekendDay" align="center">17</td><td align="center">18</td><td align="center">19</td><td class="CalTodayDay" align="center">20</td><td align="center">21</td><td align="center">22</td><td class="CalWeekendDay" align="center">23</td></tr><tr><td class="CalWeekendDay" align="center">24</td><td align="center">25</td><td align="center">26</td><td align="center">27</td><td align="center">28</td><td align="center">29</td><td class="CalWeekendDay" align="center">30</td></tr><tr><td class="CalWeekendDay" align="center">31</td><td class="CalOtherMonthDay" align="center">1</td><td class="CalOtherMonthDay" align="center">2</td><td class="CalOtherMonthDay" align="center">3</td><td class="CalOtherMonthDay" align="center">4</td><td class="CalOtherMonthDay" align="center">5</td><td class="CalOtherMonthDay" align="center">6</td></tr>
</tbody></table></div><script type="text/javascript">loadBlogDefaultCalendar();</script></div>
			
			<div id="leftcontentcontainer">
				<div id="blog-sidecolumn"><div id="sidebar_search" class="sidebar-block">
<div id="sidebar_search" class="mySearch">
<h3 class="catListTitle">搜索</h3>
<div id="sidebar_search_box">
<div id="widget_my_zzk" class="div_my_zzk"><input type="text" id="q" onkeydown="return zzk_go_enter(event);" class="input_my_zzk">&nbsp;<input onclick="zzk_go()" type="button" value="找找看" id="btnZzk" class="btn_my_zzk"></div>
<div id="widget_my_google" class="div_my_zzk"><input type="text" name="google_q" id="google_q" onkeydown="return google_go_enter(event)" class="input_my_zzk">&nbsp;<input onclick="google_go()" type="button" value="谷歌搜索" class="btn_my_zzk"></div>
</div>
</div>

</div><div id="sidebar_shortcut" class="sidebar-block">
<div class="catListLink">
<h3 class="catListTitle">常用链接</h3>
<ul>
<li><a href="https://www.cnblogs.com/andy-zhou/p/" title="我的博客的随笔列表">我的随笔</a></li><li><a href="https://www.cnblogs.com/andy-zhou/MyComments.html" title="我发表过的评论列表">我的评论</a></li><li><a href="https://www.cnblogs.com/andy-zhou/OtherPosts.html" title="我评论过的随笔列表">我的参与</a></li><li><a href="https://www.cnblogs.com/andy-zhou/RecentComments.html" title="我的博客的评论列表">最新评论</a></li><li><a href="https://www.cnblogs.com/andy-zhou/tag/" title="我的博客的标签列表">我的标签</a></li>
<li><a id="itemListLink" onclick="this.blur();WarpClass(&#39;itemListLink&#39;, &#39;itemListLin_con&#39;);return false;" href="https://www.cnblogs.com/andy-zhou/p/5327288.html#">更多链接</a></li>
</ul>
<div id="itemListLin_con" style="display:none;">
<ul>

</ul>
</div>
</div></div><div id="sidebar_toptags" class="sidebar-block"></div><div id="sidebar_categories">
<div class="catListPostCategory">
<h3 class="catListTitle">随笔分类</h3>

<ul>

<li><a id="CatList_LinkList_0_Link_0" href="https://www.cnblogs.com/andy-zhou/category/807540.html">Algorithm(6)</a> </li>

<li><a id="CatList_LinkList_0_Link_1" href="https://www.cnblogs.com/andy-zhou/category/806328.html">Collection(4)</a> </li>

<li><a id="CatList_LinkList_0_Link_2" href="https://www.cnblogs.com/andy-zhou/category/806121.html">Concurrent(19)</a> </li>

<li><a id="CatList_LinkList_0_Link_3" href="https://www.cnblogs.com/andy-zhou/category/805000.html">DB &amp; SQL(4)</a> </li>

<li><a id="CatList_LinkList_0_Link_4" href="https://www.cnblogs.com/andy-zhou/category/802838.html">Design(1)</a> </li>

<li><a id="CatList_LinkList_0_Link_5" href="https://www.cnblogs.com/andy-zhou/category/802818.html">Framework(1)</a> </li>

<li><a id="CatList_LinkList_0_Link_6" href="https://www.cnblogs.com/andy-zhou/category/802814.html">Front-End(2)</a> </li>

<li><a id="CatList_LinkList_0_Link_7" href="https://www.cnblogs.com/andy-zhou/category/802817.html">Git(4)</a> </li>

<li><a id="CatList_LinkList_0_Link_8" href="https://www.cnblogs.com/andy-zhou/category/806109.html">Hash &amp; Cached(1)</a> </li>

<li><a id="CatList_LinkList_0_Link_9" href="https://www.cnblogs.com/andy-zhou/category/809122.html">HTTP &amp; HTTPS(5)</a> </li>

<li><a id="CatList_LinkList_0_Link_10" href="https://www.cnblogs.com/andy-zhou/category/803537.html">Interview(16)</a> </li>

<li><a id="CatList_LinkList_0_Link_11" href="https://www.cnblogs.com/andy-zhou/category/755371.html">iOS(11)</a> </li>

<li><a id="CatList_LinkList_0_Link_12" href="https://www.cnblogs.com/andy-zhou/category/809150.html">iOS-Study(1)</a> </li>

<li><a id="CatList_LinkList_0_Link_13" href="https://www.cnblogs.com/andy-zhou/category/802621.html">Java(16)</a> </li>

<li><a id="CatList_LinkList_0_Link_14" href="https://www.cnblogs.com/andy-zhou/category/806821.html">Java Exception(3)</a> </li>

<li><a id="CatList_LinkList_0_Link_15" href="https://www.cnblogs.com/andy-zhou/category/806785.html">Java I/O(2)</a> </li>

<li><a id="CatList_LinkList_0_Link_16" href="https://www.cnblogs.com/andy-zhou/category/807545.html">Java NIO(2)</a> </li>

<li><a id="CatList_LinkList_0_Link_17" href="https://www.cnblogs.com/andy-zhou/category/804986.html">JSP &amp; Servlet(2)</a> </li>

<li><a id="CatList_LinkList_0_Link_18" href="https://www.cnblogs.com/andy-zhou/category/806120.html">JVM(13)</a> </li>

<li><a id="CatList_LinkList_0_Link_19" href="https://www.cnblogs.com/andy-zhou/category/802809.html">Linux(3)</a> </li>

<li><a id="CatList_LinkList_0_Link_20" href="https://www.cnblogs.com/andy-zhou/category/755438.html">Markdown(3)</a> </li>

<li><a id="CatList_LinkList_0_Link_21" href="https://www.cnblogs.com/andy-zhou/category/804905.html">Patterns(4)</a> </li>

<li><a id="CatList_LinkList_0_Link_22" href="https://www.cnblogs.com/andy-zhou/category/802824.html">Python(1)</a> </li>

<li><a id="CatList_LinkList_0_Link_23" href="https://www.cnblogs.com/andy-zhou/category/811784.html">Redis(1)</a> </li>

<li><a id="CatList_LinkList_0_Link_24" href="https://www.cnblogs.com/andy-zhou/category/802831.html">Text(16)</a> </li>

<li><a id="CatList_LinkList_0_Link_25" href="https://www.cnblogs.com/andy-zhou/category/883668.html">Tomcat(2)</a> </li>

<li><a id="CatList_LinkList_0_Link_26" href="https://www.cnblogs.com/andy-zhou/category/962966.html">剑指算法题(69)</a> </li>

</ul>

</div>

<div class="catListPostArchive">
<h3 class="catListTitle">随笔档案</h3>

<ul>

<li><a id="CatList_LinkList_1_Link_0" href="https://www.cnblogs.com/andy-zhou/archive/2017/04.html">2017年4月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_1" href="https://www.cnblogs.com/andy-zhou/archive/2017/03.html">2017年3月 (72)</a> </li>

<li><a id="CatList_LinkList_1_Link_2" href="https://www.cnblogs.com/andy-zhou/archive/2017/02.html">2017年2月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_3" href="https://www.cnblogs.com/andy-zhou/archive/2017/01.html">2017年1月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_4" href="https://www.cnblogs.com/andy-zhou/archive/2016/09.html">2016年9月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_5" href="https://www.cnblogs.com/andy-zhou/archive/2016/05.html">2016年5月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_6" href="https://www.cnblogs.com/andy-zhou/archive/2016/04.html">2016年4月 (21)</a> </li>

<li><a id="CatList_LinkList_1_Link_7" href="https://www.cnblogs.com/andy-zhou/archive/2016/03.html">2016年3月 (113)</a> </li>

<li><a id="CatList_LinkList_1_Link_8" href="https://www.cnblogs.com/andy-zhou/archive/2015/11.html">2015年11月 (3)</a> </li>

</ul>

</div>

<div class="catListImageCategory">
<h3 class="catListTitle">相册</h3>

<ul>

<li><a id="CatList_LinkList_2_Link_0" href="https://www.cnblogs.com/andy-zhou/gallery/803849.html" rel="nofollow">133个Java面试问题列表(4)</a> </li>

<li><a id="CatList_LinkList_2_Link_1" href="https://www.cnblogs.com/andy-zhou/gallery/804987.html" rel="nofollow">Ajax原理学习(1)</a> </li>

<li><a id="CatList_LinkList_2_Link_2" href="https://www.cnblogs.com/andy-zhou/gallery/1253642.html" rel="nofollow">Andy React Study(1)</a> </li>

<li><a id="CatList_LinkList_2_Link_3" href="https://www.cnblogs.com/andy-zhou/gallery/805982.html" rel="nofollow">Git 分支管理是一门艺术(5)</a> </li>

<li><a id="CatList_LinkList_2_Link_4" href="https://www.cnblogs.com/andy-zhou/gallery/816916.html" rel="nofollow">Git使用教程(73)</a> </li>

<li><a id="CatList_LinkList_2_Link_5" href="https://www.cnblogs.com/andy-zhou/gallery/817145.html" rel="nofollow">HashMap多线程并发问题分析(5)</a> </li>

<li><a id="CatList_LinkList_2_Link_6" href="https://www.cnblogs.com/andy-zhou/gallery/803540.html" rel="nofollow">Interview(1)</a> </li>

<li><a id="CatList_LinkList_2_Link_7" href="https://www.cnblogs.com/andy-zhou/gallery/805770.html" rel="nofollow">iOS 面试基础题目(1)</a> </li>

<li><a id="CatList_LinkList_2_Link_8" href="https://www.cnblogs.com/andy-zhou/gallery/802934.html" rel="nofollow">iOS应用架构谈 view层的组织和调用方案(3)</a> </li>

<li><a id="CatList_LinkList_2_Link_9" href="https://www.cnblogs.com/andy-zhou/gallery/803534.html" rel="nofollow">iOS应用架构谈 组件化方案(1)</a> </li>

<li><a id="CatList_LinkList_2_Link_10" href="https://www.cnblogs.com/andy-zhou/gallery/808162.html" rel="nofollow">Java ConcurrentModificationException异常原因和解决方法(2)</a> </li>

<li><a id="CatList_LinkList_2_Link_11" href="https://www.cnblogs.com/andy-zhou/gallery/805036.html" rel="nofollow">Java I/O学习(9)</a> </li>

<li><a id="CatList_LinkList_2_Link_12" href="https://www.cnblogs.com/andy-zhou/gallery/807546.html" rel="nofollow">Java NIO：NIO概述(2)</a> </li>

<li><a id="CatList_LinkList_2_Link_13" href="https://www.cnblogs.com/andy-zhou/gallery/807560.html" rel="nofollow">Java NIO：浅析I/O模型(2)</a> </li>

<li><a id="CatList_LinkList_2_Link_14" href="https://www.cnblogs.com/andy-zhou/gallery/806866.html" rel="nofollow">Java 字节流与字符流的区别(4)</a> </li>

<li><a id="CatList_LinkList_2_Link_15" href="https://www.cnblogs.com/andy-zhou/gallery/806836.html" rel="nofollow">Java：类与继承(2)</a> </li>

<li><a id="CatList_LinkList_2_Link_16" href="https://www.cnblogs.com/andy-zhou/gallery/805267.html" rel="nofollow">Javaweb异常提示信息统一处理(6)</a> </li>

<li><a id="CatList_LinkList_2_Link_17" href="https://www.cnblogs.com/andy-zhou/gallery/806297.html" rel="nofollow">Java并发编程：Lock(2)</a> </li>

<li><a id="CatList_LinkList_2_Link_18" href="https://www.cnblogs.com/andy-zhou/gallery/806123.html" rel="nofollow">Java并发编程：synchronized(4)</a> </li>

<li><a id="CatList_LinkList_2_Link_19" href="https://www.cnblogs.com/andy-zhou/gallery/808170.html" rel="nofollow">Java并发编程：Thread类的使用(7)</a> </li>

<li><a id="CatList_LinkList_2_Link_20" href="https://www.cnblogs.com/andy-zhou/gallery/808165.html" rel="nofollow">Java并发编程：volatile关键字解析(2)</a> </li>

<li><a id="CatList_LinkList_2_Link_21" href="https://www.cnblogs.com/andy-zhou/gallery/808161.html" rel="nofollow">Java并发编程：并发容器之ConcurrentHashMap(3)</a> </li>

<li><a id="CatList_LinkList_2_Link_22" href="https://www.cnblogs.com/andy-zhou/gallery/808169.html" rel="nofollow">Java并发编程：如何创建线程(1)</a> </li>

<li><a id="CatList_LinkList_2_Link_23" href="https://www.cnblogs.com/andy-zhou/gallery/808164.html" rel="nofollow">Java并发编程：深入剖析ThreadLocal(8)</a> </li>

<li><a id="CatList_LinkList_2_Link_24" href="https://www.cnblogs.com/andy-zhou/gallery/808163.html" rel="nofollow">Java并发编程：同步容器(3)</a> </li>

<li><a id="CatList_LinkList_2_Link_25" href="https://www.cnblogs.com/andy-zhou/gallery/803905.html" rel="nofollow">Java并发编程：性能、扩展性和响应(1)</a> </li>

<li><a id="CatList_LinkList_2_Link_26" href="https://www.cnblogs.com/andy-zhou/gallery/807579.html" rel="nofollow">Java常用排序算法/程序员必须掌握的8大排序算法(11)</a> </li>

<li><a id="CatList_LinkList_2_Link_27" href="https://www.cnblogs.com/andy-zhou/gallery/804972.html" rel="nofollow">Java基础之泛型(2)</a> </li>

<li><a id="CatList_LinkList_2_Link_28" href="https://www.cnblogs.com/andy-zhou/gallery/804953.html" rel="nofollow">Java基础之集合(4)</a> </li>

<li><a id="CatList_LinkList_2_Link_29" href="https://www.cnblogs.com/andy-zhou/gallery/806325.html" rel="nofollow">Java集合框架：HashMap(3)</a> </li>

<li><a id="CatList_LinkList_2_Link_30" href="https://www.cnblogs.com/andy-zhou/gallery/804941.html" rel="nofollow">Java经典设计模式(4)</a> </li>

<li><a id="CatList_LinkList_2_Link_31" href="https://www.cnblogs.com/andy-zhou/gallery/806853.html" rel="nofollow">Java垃圾回收机制(4)</a> </li>

<li><a id="CatList_LinkList_2_Link_32" href="https://www.cnblogs.com/andy-zhou/gallery/806319.html" rel="nofollow">Java内部类详解(5)</a> </li>

<li><a id="CatList_LinkList_2_Link_33" href="https://www.cnblogs.com/andy-zhou/gallery/805012.html" rel="nofollow">Java内存管理(2)</a> </li>

<li><a id="CatList_LinkList_2_Link_34" href="https://www.cnblogs.com/andy-zhou/gallery/807043.html" rel="nofollow">Java输入输出流(17)</a> </li>

<li><a id="CatList_LinkList_2_Link_35" href="https://www.cnblogs.com/andy-zhou/gallery/811437.html" rel="nofollow">Java位操作全面总结(1)</a> </li>

<li><a id="CatList_LinkList_2_Link_36" href="https://www.cnblogs.com/andy-zhou/gallery/806198.html" rel="nofollow">Java线程面试题 Top 50(1)</a> </li>

<li><a id="CatList_LinkList_2_Link_37" href="https://www.cnblogs.com/andy-zhou/gallery/806130.html" rel="nofollow">Java虚拟机类加载机制(1)</a> </li>

<li><a id="CatList_LinkList_2_Link_38" href="https://www.cnblogs.com/andy-zhou/gallery/807049.html" rel="nofollow">Java异常处理和设计(4)</a> </li>

<li><a id="CatList_LinkList_2_Link_39" href="https://www.cnblogs.com/andy-zhou/gallery/805264.html" rel="nofollow">Java异常封装(2)</a> </li>

<li><a id="CatList_LinkList_2_Link_40" href="https://www.cnblogs.com/andy-zhou/gallery/805276.html" rel="nofollow">Java中synchronized的使用实例(2)</a> </li>

<li><a id="CatList_LinkList_2_Link_41" href="https://www.cnblogs.com/andy-zhou/gallery/806841.html" rel="nofollow">Java中的static关键字解析(2)</a> </li>

<li><a id="CatList_LinkList_2_Link_42" href="https://www.cnblogs.com/andy-zhou/gallery/807048.html" rel="nofollow">JVM的内存区域划分(3)</a> </li>

<li><a id="CatList_LinkList_2_Link_43" href="https://www.cnblogs.com/andy-zhou/gallery/806435.html" rel="nofollow">JVM调优总结(21)</a> </li>

<li><a id="CatList_LinkList_2_Link_44" href="https://www.cnblogs.com/andy-zhou/gallery/811918.html" rel="nofollow">MySQL 死锁问题分析(13)</a> </li>

<li><a id="CatList_LinkList_2_Link_45" href="https://www.cnblogs.com/andy-zhou/gallery/807034.html" rel="nofollow">MySQL通用优化手册(42)</a> </li>

<li><a id="CatList_LinkList_2_Link_46" href="https://www.cnblogs.com/andy-zhou/gallery/805287.html" rel="nofollow">Objective-C与JavaScript交互的那些事(2)</a> </li>

<li><a id="CatList_LinkList_2_Link_47" href="https://www.cnblogs.com/andy-zhou/gallery/811785.html" rel="nofollow">Redis时延问题分析及应对(3)</a> </li>

<li><a id="CatList_LinkList_2_Link_48" href="https://www.cnblogs.com/andy-zhou/gallery/805070.html" rel="nofollow">Servlet再度学习(2)</a> </li>

<li><a id="CatList_LinkList_2_Link_49" href="https://www.cnblogs.com/andy-zhou/gallery/805278.html" rel="nofollow">Spring中@Transactional事务回滚(2)</a> </li>

<li><a id="CatList_LinkList_2_Link_50" href="https://www.cnblogs.com/andy-zhou/gallery/805095.html" rel="nofollow">SQL实例整理(7)</a> </li>

<li><a id="CatList_LinkList_2_Link_51" href="https://www.cnblogs.com/andy-zhou/gallery/934035.html" rel="nofollow">Tomcat APR &amp; Linux Optimization(10)</a> </li>

<li><a id="CatList_LinkList_2_Link_52" href="https://www.cnblogs.com/andy-zhou/gallery/947016.html" rel="nofollow">Trace VM(2)</a> </li>

<li><a id="CatList_LinkList_2_Link_53" href="https://www.cnblogs.com/andy-zhou/gallery/953941.html" rel="nofollow">Tuning Optimization(7)</a> </li>

<li><a id="CatList_LinkList_2_Link_54" href="https://www.cnblogs.com/andy-zhou/gallery/802666.html" rel="nofollow">Xcode + Swift 制作动态原型(18)</a> </li>

<li><a id="CatList_LinkList_2_Link_55" href="https://www.cnblogs.com/andy-zhou/gallery/805768.html" rel="nofollow">阿里Linux Shell脚本面试25个经典问答(13)</a> </li>

<li><a id="CatList_LinkList_2_Link_56" href="https://www.cnblogs.com/andy-zhou/gallery/803919.html" rel="nofollow">初探Java字符串(7)</a> </li>

<li><a id="CatList_LinkList_2_Link_57" href="https://www.cnblogs.com/andy-zhou/gallery/972210.html" rel="nofollow">递归回溯groupSum(1)</a> </li>

<li><a id="CatList_LinkList_2_Link_58" href="https://www.cnblogs.com/andy-zhou/gallery/806102.html" rel="nofollow">对一致性Hash算法，Java代码实现的深入研究(2)</a> </li>

<li><a id="CatList_LinkList_2_Link_59" href="https://www.cnblogs.com/andy-zhou/gallery/811968.html" rel="nofollow">画图解释 SQL Join 语句(6)</a> </li>

<li><a id="CatList_LinkList_2_Link_60" href="https://www.cnblogs.com/andy-zhou/gallery/805985.html" rel="nofollow">简明 Git 命令速查表(1)</a> </li>

<li><a id="CatList_LinkList_2_Link_61" href="https://www.cnblogs.com/andy-zhou/gallery/965584.html" rel="nofollow">剑指Offer(2)</a> </li>

<li><a id="CatList_LinkList_2_Link_62" href="https://www.cnblogs.com/andy-zhou/gallery/811282.html" rel="nofollow">理解Cookie和Session机制(5)</a> </li>

<li><a id="CatList_LinkList_2_Link_63" href="https://www.cnblogs.com/andy-zhou/gallery/818571.html" rel="nofollow">理解HTTP幂等性(2)</a> </li>

<li><a id="CatList_LinkList_2_Link_64" href="https://www.cnblogs.com/andy-zhou/gallery/806384.html" rel="nofollow">理解Java虚拟机体系结构(8)</a> </li>

<li><a id="CatList_LinkList_2_Link_65" href="https://www.cnblogs.com/andy-zhou/gallery/811989.html" rel="nofollow">秒杀系统架构分析与实战(25)</a> </li>

<li><a id="CatList_LinkList_2_Link_66" href="https://www.cnblogs.com/andy-zhou/gallery/807045.html" rel="nofollow">浅谈Java中的equals和==(2)</a> </li>

<li><a id="CatList_LinkList_2_Link_67" href="https://www.cnblogs.com/andy-zhou/gallery/806830.html" rel="nofollow">浅谈Java中的深拷贝和浅拷贝(1)</a> </li>

<li><a id="CatList_LinkList_2_Link_68" href="https://www.cnblogs.com/andy-zhou/gallery/806300.html" rel="nofollow">浅析Java中的final关键字(3)</a> </li>

<li><a id="CatList_LinkList_2_Link_69" href="https://www.cnblogs.com/andy-zhou/gallery/807046.html" rel="nofollow">浅析Java中的访问权限控制(4)</a> </li>

<li><a id="CatList_LinkList_2_Link_70" href="https://www.cnblogs.com/andy-zhou/gallery/806133.html" rel="nofollow">三张图彻底了解Java中字符串的不变性(3)</a> </li>

<li><a id="CatList_LinkList_2_Link_71" href="https://www.cnblogs.com/andy-zhou/gallery/807047.html" rel="nofollow">深入剖析Java中的装箱和拆箱(1)</a> </li>

<li><a id="CatList_LinkList_2_Link_72" href="https://www.cnblogs.com/andy-zhou/gallery/806681.html" rel="nofollow">什么是堆和栈，它们在哪儿？(4)</a> </li>

<li><a id="CatList_LinkList_2_Link_73" href="https://www.cnblogs.com/andy-zhou/gallery/755355.html" rel="nofollow">使用XIB实现一个简单view(3)</a> </li>

<li><a id="CatList_LinkList_2_Link_74" href="https://www.cnblogs.com/andy-zhou/gallery/809125.html" rel="nofollow">详解https是如何确保安全的？(2)</a> </li>

<li><a id="CatList_LinkList_2_Link_75" href="https://www.cnblogs.com/andy-zhou/gallery/806055.html" rel="nofollow">在Xcode中使用Git进行源码版本控制(40)</a> </li>

</ul>

</div>

</div><div id="sidebar_recentcomments" class="sidebar-block"><div id="recent_comments_wrap">
<div class="catListComment">
<h3 class="catListTitle">最新评论</h3>

	<div id="RecentCommentsBlock"><ul>
        <li class="recent_comment_title"><a href="https://www.cnblogs.com/andy-zhou/p/5360107.html#4172754">1. Re:理解Cookie和Session机制</a></li>
        <li class="recent_comment_body">如果本地的cookie是找不到的，那是不是就是安全的？</li>
        <li class="recent_comment_author">--善见致知</li>
        <li class="recent_comment_title"><a href="https://www.cnblogs.com/andy-zhou/p/5360107.html#4161472">2. Re:理解Cookie和Session机制</a></li>
        <li class="recent_comment_body">讲得蛮清晰。</li>
        <li class="recent_comment_author">--btwangzhi</li>
        <li class="recent_comment_title"><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html#4159404">3. Re:JVM调优总结</a></li>
        <li class="recent_comment_body">持久层1.7就开始去除了, 1.8就完全没有了, 换成了metaspace元数据空间, 存在系统内存里面的.</li>
        <li class="recent_comment_author">--逆光影者</li>
        <li class="recent_comment_title"><a href="https://www.cnblogs.com/andy-zhou/p/5364136.html#4146716">4. Re:秒杀系统架构分析与实战</a></li>
        <li class="recent_comment_body">站点层设计中，提到的页面缓存指什么？NGINX缓存吗？希望楼主能说一下</li>
        <li class="recent_comment_author">--威利旺卡</li>
        <li class="recent_comment_title"><a href="https://www.cnblogs.com/andy-zhou/p/5364136.html#4143975">5. Re:秒杀系统架构分析与实战</a></li>
        <li class="recent_comment_body">有一点不太懂  “下单服务器检查本机已处理的下单请求数目”  这个用什么技术实现呢？楼主能说一下吗？用Java volatile变量实现？</li>
        <li class="recent_comment_author">--威利旺卡</li>
</ul>
</div>
</div>
</div></div><div id="sidebar_topviewedposts" class="sidebar-block"><div id="topview_posts_wrap">
<div class="catListView">
<h3 class="catListTitle">阅读排行榜</h3>
	<div id="TopViewPostsBlock"><ul><li><a href="https://www.cnblogs.com/andy-zhou/p/5360107.html">1. 理解Cookie和Session机制(127912)</a></li><li><a href="https://www.cnblogs.com/andy-zhou/p/5339683.html">2. Java ConcurrentModificationException异常原因和解决方法(102977)</a></li><li><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html">3. JVM调优总结(40950)</a></li><li><a href="https://www.cnblogs.com/andy-zhou/p/5402984.html">4. HashMap多线程并发问题分析(34153)</a></li><li><a href="https://www.cnblogs.com/andy-zhou/p/5317820.html">5. Javaweb异常提示信息统一处理(32854)</a></li></ul></div>
</div>
</div></div><div id="sidebar_topcommentedposts" class="sidebar-block"><div id="topfeedback_posts_wrap">
<div class="catListFeedback">
<h3 class="catListTitle">评论排行榜</h3>
	<div id="TopFeedbackPostsBlock"><ul><li><a href="https://www.cnblogs.com/andy-zhou/p/5360107.html">1. 理解Cookie和Session机制(18)</a></li><li><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html">2. JVM调优总结(4)</a></li><li><a href="https://www.cnblogs.com/andy-zhou/p/5364136.html">3. 秒杀系统架构分析与实战(4)</a></li><li><a href="https://www.cnblogs.com/andy-zhou/p/5339683.html">4. Java ConcurrentModificationException异常原因和解决方法(3)</a></li><li><a href="https://www.cnblogs.com/andy-zhou/p/5402984.html">5. HashMap多线程并发问题分析(2)</a></li></ul></div>
</div>
</div></div><div id="sidebar_topdiggedposts" class="sidebar-block"><div id="topdigg_posts_wrap">
<h3 class="catListTitle">推荐排行榜</h3>
<div class="RecentComment">
	<div id="TopDiggPostsBlock"><ul><li><a href="https://www.cnblogs.com/andy-zhou/p/5360107.html">1. 理解Cookie和Session机制(47)</a></li><li><a href="https://www.cnblogs.com/andy-zhou/p/5327288.html">2. JVM调优总结(17)</a></li><li><a href="https://www.cnblogs.com/andy-zhou/p/5339683.html">3. Java ConcurrentModificationException异常原因和解决方法(13)</a></li><li><a href="https://www.cnblogs.com/andy-zhou/p/5364136.html">4. 秒杀系统架构分析与实战(12)</a></li><li><a href="https://www.cnblogs.com/andy-zhou/p/5402984.html">5. HashMap多线程并发问题分析(8)</a></li></ul></div>
</div></div></div></div><script type="text/javascript">loadBlogSideColumn();</script>
			</div>
			
		</div><!--end: sideBarMain -->
		<div class="clear"></div>
		<div id="footer">
			
<!--done-->
Copyright ©2019 Andrew.Zhou
		</div><!--end: footer -->
	</div><!--end: sideBar 侧边栏容器 -->
</div><!--end: home 自定义的最大容器 -->
</center>

<!--PageEndHtml Block Begin-->
<script type="text/javascript">  
    var setMyBlog = {
        setCopyright: function() {
            //设置版权信息，转载出处自动根据页面url生成
            var info_str = '<p>作者：<a target="_blank">@gzdaijie</a><br>'+
                '本文为作者原创，转载请注明出处：<a class="uri"></a></p><hr></hr>', 
                info = $(info_str),
                info_a = info.find("a"),
                url = window.location.href;
            $(info_a[0]).attr("href","https://github.com/gzdaijie");
            $(info_a[1]).attr("href",url).text(url);
            $("#cnblogs_post_body").prepend(info);
        },
        setCodeRow: function(){
            // 代码行号显示
            var pre = $("pre.sourceCode"); //选中需要更改的部分
            if(pre && pre.length){
                pre.each(function() {
                    var item = $(this);
                    var lang = item.attr("class").split(" ")[1]; //判断高亮的语言
                    item.html(item.html().replace(/<[^>]+>/g,"")); //将<pre>标签中的html标签去掉
                    item.removeClass().addClass("brush: " + lang +";"); //根据语言添加笔刷
                    SyntaxHighlighter.all();
                })
            }
        },
        setAtarget: function() {
            // 博客内的链接在新窗口打开
            $("#cnblogs_post_body a").each(function(){
                this.target = "_blank";
            }) 
        },
        setContent: function() {
            // 根据h2、h3标签自动生成目录
            var captions_ori = $("#cnblogs_post_body h2"),
                //captions = $("#cnblogs_post_body h2,#cnblogs_post_body h3").clone(),
                captions = $("#cnblogs_post_body h2").clone(),
                content = $("<blockquote><h4>目录</h4></blockquote>");
            $("#cnblogs_post_body").prepend(content.append(captions));
            var index = -1;
            captions.replaceWith(function(){
                var self = this;
                if(self.tagName == "H2" || self.tagName == "h2"){
                    // 设置点击目录跳转
                    index += 1;
                    $('<a name="' + '_caption_' + index + '"></a>').insertBefore(captions_ori[index]); 
                    return '<a href="#_caption_' + index + '"><strong>' + self.innerHTML + '</strong></a><br>';
                } else {
                    return self.innerHTML + "<br>";
                }
            });
        },
        runAll: function() {
            /* 运行所有方法
             * setAtarget() 博客园内标签新窗口打开
             * setContent() 设置目录
             * setCopyright() 设置版权信息
             * setCodeRow() 代码行号显示
             */ 
            this.setAtarget(); 
            this.setContent();
            //this.setCopyright();
            this.setCodeRow();
        }
    }
    setMyBlog.runAll();
</script>
<!--PageEndHtml Block End-->


<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Math-italic, sans-serif;"></div></div><st-div id="__selection-translator__"> <st-div class="__st-box__" style="display: none; position: fixed; z-index: 99999; left: 0px; top: 0px; transform: translateX(826px) translateY(351px);"> <st-header> <st-span class="st-icon-pin" title="固定"></st-span> <st-span class="st-icon-down-open" title="展开"></st-span> <st-span class="st-icon-cog" title="设置"></st-span> </st-header> <st-div class="__query-form__" style="display: none;"> <st-div> <textarea placeholder="输入要翻译的句子或单词"></textarea> </st-div> <st-div> <select> <option value="">自动判断</option> <option value="zh">中文</option><option value="zh-CN">中文(简体)</option><option value="zh-HK">中文(香港)</option><option value="zh-TW">中文(繁体)</option><option value="en">英语</option><option value="ja">日语</option><option value="ko">朝鲜语</option><option value="de">德语</option><option value="fr">法语</option><option value="ru">俄语</option><option value="th">泰语</option><option value="af">南非语</option><option value="ar">阿拉伯语</option><option value="az">阿塞拜疆语</option><option value="be">比利时语</option><option value="bg">保加利亚语</option><option value="ca">加泰隆语</option><option value="cs">捷克语</option><option value="cy">威尔士语</option><option value="da">丹麦语</option><option value="dv">第维埃语</option><option value="el">希腊语</option><option value="eo">世界语</option><option value="es">西班牙语</option><option value="et">爱沙尼亚语</option><option value="eu">巴士克语</option><option value="fa">法斯语</option><option value="fi">芬兰语</option><option value="fo">法罗语</option><option value="gl">加里西亚语</option><option value="gu">古吉拉特语</option><option value="he">希伯来语</option><option value="hi">印地语</option><option value="hr">克罗地亚语</option><option value="hu">匈牙利语</option><option value="hy">亚美尼亚语</option><option value="id">印度尼西亚语</option><option value="is">冰岛语</option><option value="it">意大利语</option><option value="ka">格鲁吉亚语</option><option value="kk">哈萨克语</option><option value="kn">卡纳拉语</option><option value="kok">孔卡尼语</option><option value="ky">吉尔吉斯语</option><option value="lt">立陶宛语</option><option value="lv">拉脱维亚语</option><option value="mi">毛利语</option><option value="mk">马其顿语</option><option value="mn">蒙古语</option><option value="mr">马拉地语</option><option value="ms">马来语</option><option value="mt">马耳他语</option><option value="nb">挪威语(伯克梅尔)</option><option value="nl">荷兰语</option><option value="ns">北梭托语</option><option value="pa">旁遮普语</option><option value="pl">波兰语</option><option value="pt">葡萄牙语</option><option value="qu">克丘亚语</option><option value="ro">罗马尼亚语</option><option value="sa">梵文</option><option value="se">北萨摩斯语</option><option value="sk">斯洛伐克语</option><option value="sl">斯洛文尼亚语</option><option value="sq">阿尔巴尼亚语</option><option value="sv">瑞典语</option><option value="sw">斯瓦希里语</option><option value="syr">叙利亚语</option><option value="ta">泰米尔语</option><option value="te">泰卢固语</option><option value="tl">塔加路语</option><option value="tn">茨瓦纳语</option><option value="tr">土耳其语</option><option value="ts">宗加语</option><option value="tt">鞑靼语</option><option value="uk">乌克兰语</option><option value="ur">乌都语</option><option value="uz">乌兹别克语</option><option value="vi">越南语</option><option value="xh">班图语</option><option value="zu">祖鲁语</option> </select> <st-div class="__exchange__"> <st-span class="st-icon-exchange"></st-span> </st-div> <select> <option value="">自动选择</option> <option value="zh">中文</option><option value="zh-CN">中文(简体)</option><option value="zh-HK">中文(香港)</option><option value="zh-TW">中文(繁体)</option><option value="en">英语</option><option value="ja">日语</option><option value="ko">朝鲜语</option><option value="de">德语</option><option value="fr">法语</option><option value="ru">俄语</option><option value="th">泰语</option><option value="af">南非语</option><option value="ar">阿拉伯语</option><option value="az">阿塞拜疆语</option><option value="be">比利时语</option><option value="bg">保加利亚语</option><option value="ca">加泰隆语</option><option value="cs">捷克语</option><option value="cy">威尔士语</option><option value="da">丹麦语</option><option value="dv">第维埃语</option><option value="el">希腊语</option><option value="eo">世界语</option><option value="es">西班牙语</option><option value="et">爱沙尼亚语</option><option value="eu">巴士克语</option><option value="fa">法斯语</option><option value="fi">芬兰语</option><option value="fo">法罗语</option><option value="gl">加里西亚语</option><option value="gu">古吉拉特语</option><option value="he">希伯来语</option><option value="hi">印地语</option><option value="hr">克罗地亚语</option><option value="hu">匈牙利语</option><option value="hy">亚美尼亚语</option><option value="id">印度尼西亚语</option><option value="is">冰岛语</option><option value="it">意大利语</option><option value="ka">格鲁吉亚语</option><option value="kk">哈萨克语</option><option value="kn">卡纳拉语</option><option value="kok">孔卡尼语</option><option value="ky">吉尔吉斯语</option><option value="lt">立陶宛语</option><option value="lv">拉脱维亚语</option><option value="mi">毛利语</option><option value="mk">马其顿语</option><option value="mn">蒙古语</option><option value="mr">马拉地语</option><option value="ms">马来语</option><option value="mt">马耳他语</option><option value="nb">挪威语(伯克梅尔)</option><option value="nl">荷兰语</option><option value="ns">北梭托语</option><option value="pa">旁遮普语</option><option value="pl">波兰语</option><option value="pt">葡萄牙语</option><option value="qu">克丘亚语</option><option value="ro">罗马尼亚语</option><option value="sa">梵文</option><option value="se">北萨摩斯语</option><option value="sk">斯洛伐克语</option><option value="sl">斯洛文尼亚语</option><option value="sq">阿尔巴尼亚语</option><option value="sv">瑞典语</option><option value="sw">斯瓦希里语</option><option value="syr">叙利亚语</option><option value="ta">泰米尔语</option><option value="te">泰卢固语</option><option value="tl">塔加路语</option><option value="tn">茨瓦纳语</option><option value="tr">土耳其语</option><option value="ts">宗加语</option><option value="tt">鞑靼语</option><option value="uk">乌克兰语</option><option value="ur">乌都语</option><option value="uz">乌兹别克语</option><option value="vi">越南语</option><option value="xh">班图语</option><option value="zu">祖鲁语</option> </select> </st-div> <st-div> <select> <option value="YouDao">有道翻译</option> <option value="BaiDu">百度翻译</option> <option value="Google">谷歌翻译</option> <option value="GoogleCN">谷歌翻译（国内）</option> </select> <st-div class="__action-list__"> <st-div class="__button__ __btn-translate__">翻译 <st-span class="st-icon-down-dir"></st-span> </st-div> <st-div class="__expand__"> <st-div class="__button__">朗读</st-div> <st-div class="__button__">复制</st-div> </st-div> </st-div> </st-div> </st-div> <st-div class="__translate-result__" style="display: none;">正在查询，请稍候……</st-div> <st-div class="__translate-result__"> <st-div style="display: none;"> <st-span></st-span> <st-span class="__retry__">重试</st-span> </st-div> <st-div> <st-div class="__phonetic__"> <st-span style="display: none;"></st-span> <st-span class="__copy-and-read__"> <st-span>朗读</st-span> <st-span style="display: none;">复制</st-span> </st-span> </st-div> <st-div style="display: none;"> <st-ul>  </st-ul> <st-div class="__copy-and-read__"> <st-span class="__copy-and-read__">复制</st-span> </st-div> </st-div> <st-div style="display: none;">  <st-div class="__copy-and-read__"> <st-span class="__copy-and-read__">朗读</st-span> <st-span class="__copy-and-read__">复制</st-span> </st-div> </st-div> </st-div> </st-div> <st-footer> <st-span style="">via <a target="_blank" href="https://www.cnblogs.com/andy-zhou/p/5327288.html">谷歌翻译（国内）</a></st-span> </st-footer> </st-div> <st-div class="__st-btn__" style="display: none; position: fixed; z-index: 99999; left: 0px; top: 0px; transform: translateX(826px) translateY(351px);">译</st-div> </st-div></body></html>